import{r as D,j as pe}from"./index-8bORwA5x.js";import{R as Ir,T as as,b as Un,c as Fr,d as zt,I as is,S as St,D as Rr,V as $,e as Rt,f as Tt,g as or,Q as mt,O as Kt,h as _e,P as mn,i as os,j as cs,L as Zn,k as Qt,l as it,M as ze,m as We,n as ls,o as us,p as As,q as Bt,r as hs,s as ds,t as Tr,v as fs,w as ps,B as jt,x as ms,y as Dr,N as Bs,z as gs,A as Cs,E as Ge,G as Pn,H as Jn,J as vs,K as $e,U as Es,W as bn,X as Ms,Y as br,Z as bt,$ as Is,a0 as yr,a1 as Fs,a2 as Rs,a3 as Ts,a4 as Ds,a5 as bs,a6 as yn,a7 as Xt,a8 as ys,a9 as Gs,aa as ws,ab as Ss,ac as Gr,ad as xs,ae as st,af as cr,ag as lr,ah as ur,ai as _s,aj as Hs,ak as Yn,al as wr,am as Sr,an as we,ao as Ye,ap as yt,aq as Yt,ar as Ls,as as Os,at as gt,au as de,av as Ct,aw as Us,u as xt,_ as Ze,ax as xr,ay as Wn,az as Bn,aA as Ps,aB as Js,aC as Nn,aD as Ns,aE as ks,aF as Ks,aG as Qs,aH as kn,aI as js,aJ as Ar,aK as Xs,aL as Zs,aM as Ys,aN as Ws,aO as zs,aP as _r,aQ as Vs,aR as qs,aS as hr,aT as $s,aU as ea,C as ta,aV as na,aW as ra,aX as sa}from"./index-CJiBZFXR.js";import{u as aa}from"./use-in-view-Dhu8D6qM.js";import{m as Gn}from"./proxy-BN-n05Pc.js";const zn=parseInt(Ir.replace(/\D+/g,""));function dr(l,e){if(e===as)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),l;if(e===Un||e===Fr){let n=l.getIndex();if(n===null){const a=[],c=l.getAttribute("position");if(c!==void 0){for(let o=0;o<c.count;o++)a.push(o);l.setIndex(a),n=l.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),l}const t=n.count-2,r=[];if(n)if(e===Un)for(let a=1;a<=t;a++)r.push(n.getX(0)),r.push(n.getX(a)),r.push(n.getX(a+1));else for(let a=0;a<t;a++)a%2===0?(r.push(n.getX(a)),r.push(n.getX(a+1)),r.push(n.getX(a+2))):(r.push(n.getX(a+2)),r.push(n.getX(a+1)),r.push(n.getX(a)));r.length/3!==t&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=l.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),l}var Pe=Uint8Array,at=Uint16Array,Kn=Uint32Array,Hr=new Pe([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Lr=new Pe([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ia=new Pe([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Or=function(l,e){for(var n=new at(31),t=0;t<31;++t)n[t]=e+=1<<l[t-1];for(var r=new Kn(n[30]),t=1;t<30;++t)for(var s=n[t];s<n[t+1];++s)r[s]=s-n[t]<<5|t;return[n,r]},Ur=Or(Hr,2),Pr=Ur[0],oa=Ur[1];Pr[28]=258,oa[258]=28;var ca=Or(Lr,0),la=ca[0],Qn=new at(32768);for(var me=0;me<32768;++me){var nt=(me&43690)>>>1|(me&21845)<<1;nt=(nt&52428)>>>2|(nt&13107)<<2,nt=(nt&61680)>>>4|(nt&3855)<<4,Qn[me]=((nt&65280)>>>8|(nt&255)<<8)>>>1}var Zt=function(l,e,n){for(var t=l.length,r=0,s=new at(e);r<t;++r)++s[l[r]-1];var a=new at(e);for(r=0;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;var c;if(n){c=new at(1<<e);var o=15-e;for(r=0;r<t;++r)if(l[r])for(var u=r<<4|l[r],d=e-l[r],h=a[l[r]-1]++<<d,f=h|(1<<d)-1;h<=f;++h)c[Qn[h]>>>o]=u}else for(c=new at(t),r=0;r<t;++r)l[r]&&(c[r]=Qn[a[l[r]-1]++]>>>15-l[r]);return c},Vt=new Pe(288);for(var me=0;me<144;++me)Vt[me]=8;for(var me=144;me<256;++me)Vt[me]=9;for(var me=256;me<280;++me)Vt[me]=7;for(var me=280;me<288;++me)Vt[me]=8;var Jr=new Pe(32);for(var me=0;me<32;++me)Jr[me]=5;var ua=Zt(Vt,9,1),Aa=Zt(Jr,5,1),wn=function(l){for(var e=l[0],n=1;n<l.length;++n)l[n]>e&&(e=l[n]);return e},Qe=function(l,e,n){var t=e/8|0;return(l[t]|l[t+1]<<8)>>(e&7)&n},Sn=function(l,e){var n=e/8|0;return(l[n]|l[n+1]<<8|l[n+2]<<16)>>(e&7)},ha=function(l){return(l/8|0)+(l&7&&1)},da=function(l,e,n){(n==null||n>l.length)&&(n=l.length);var t=new(l instanceof at?at:l instanceof Kn?Kn:Pe)(n-e);return t.set(l.subarray(e,n)),t},fa=function(l,e,n){var t=l.length;if(!t||n&&!n.l&&t<5)return e||new Pe(0);var r=!e||n,s=!n||n.i;n||(n={}),e||(e=new Pe(t*3));var a=function(ie){var Je=e.length;if(ie>Je){var Ne=new Pe(Math.max(Je*2,ie));Ne.set(e),e=Ne}},c=n.f||0,o=n.p||0,u=n.b||0,d=n.l,h=n.d,f=n.m,B=n.n,C=t*8;do{if(!d){n.f=c=Qe(l,o,1);var v=Qe(l,o+1,3);if(o+=3,v)if(v==1)d=ua,h=Aa,f=9,B=5;else if(v==2){var H=Qe(l,o,31)+257,w=Qe(l,o+10,15)+4,b=H+Qe(l,o+5,31)+1;o+=14;for(var M=new Pe(b),x=new Pe(19),y=0;y<w;++y)x[ia[y]]=Qe(l,o+y*3,7);o+=w*3;for(var G=wn(x),U=(1<<G)-1,W=Zt(x,G,1),y=0;y<b;){var V=W[Qe(l,o,U)];o+=V&15;var g=V>>>4;if(g<16)M[y++]=g;else{var Y=0,K=0;for(g==16?(K=3+Qe(l,o,3),o+=2,Y=M[y-1]):g==17?(K=3+Qe(l,o,7),o+=3):g==18&&(K=11+Qe(l,o,127),o+=7);K--;)M[y++]=Y}}var ne=M.subarray(0,H),z=M.subarray(H);f=wn(ne),B=wn(z),d=Zt(ne,f,1),h=Zt(z,B,1)}else throw"invalid block type";else{var g=ha(o)+4,T=l[g-4]|l[g-3]<<8,R=g+T;if(R>t){if(s)throw"unexpected EOF";break}r&&a(u+T),e.set(l.subarray(g,R),u),n.b=u+=T,n.p=o=R*8;continue}if(o>C){if(s)throw"unexpected EOF";break}}r&&a(u+131072);for(var Ie=(1<<f)-1,ve=(1<<B)-1,Fe=o;;Fe=o){var Y=d[Sn(l,o)&Ie],se=Y>>>4;if(o+=Y&15,o>C){if(s)throw"unexpected EOF";break}if(!Y)throw"invalid length/literal";if(se<256)e[u++]=se;else if(se==256){Fe=o,d=null;break}else{var Ee=se-254;if(se>264){var y=se-257,ce=Hr[y];Ee=Qe(l,o,(1<<ce)-1)+Pr[y],o+=ce}var Ce=h[Sn(l,o)&ve],Se=Ce>>>4;if(!Ce)throw"invalid distance";o+=Ce&15;var z=la[Se];if(Se>3){var ce=Lr[Se];z+=Sn(l,o)&(1<<ce)-1,o+=ce}if(o>C){if(s)throw"unexpected EOF";break}r&&a(u+131072);for(var ot=u+Ee;u<ot;u+=4)e[u]=e[u-z],e[u+1]=e[u+1-z],e[u+2]=e[u+2-z],e[u+3]=e[u+3-z];u=ot}}n.l=d,n.p=Fe,n.b=u,d&&(c=1,n.m=f,n.d=h,n.n=B)}while(!c);return u==e.length?e:da(e,0,u)},pa=new Pe(0),ma=function(l){if((l[0]&15)!=8||l[0]>>>4>7||(l[0]<<8|l[1])%31)throw"invalid zlib data";if(l[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function An(l,e){return fa((ma(l),l.subarray(2,-4)),e)}var Ba=typeof TextDecoder<"u"&&new TextDecoder,ga=0;try{Ba.decode(pa,{stream:!0}),ga=1}catch{}const Ca=l=>l&&l.isCubeTexture;class va extends zt{constructor(e,n){var t,r;const s=Ca(e),c=((r=s?(t=e.image[0])==null?void 0:t.width:e.image.width)!=null?r:1024)/4,o=Math.floor(Math.log2(c)),u=Math.pow(2,o),d=3*Math.max(u,16*7),h=4*u,f=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/d}`,`#define CUBEUV_TEXEL_HEIGHT ${1/h}`,`#define CUBEUV_MAX_MIP ${o}.0`],B=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,C=f.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${zn>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,v={map:{value:e},height:{value:(n==null?void 0:n.height)||15},radius:{value:(n==null?void 0:n.radius)||100}},g=new is(1,16),T=new St({uniforms:v,fragmentShader:C,vertexShader:B,side:Rr});super(g,T)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var Ea=Object.defineProperty,Ma=(l,e,n)=>e in l?Ea(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,Ia=(l,e,n)=>(Ma(l,e+"",n),n);class Fa{constructor(){Ia(this,"_listeners")}addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const t=this._listeners;t[e]===void 0&&(t[e]=[]),t[e].indexOf(n)===-1&&t[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const t=this._listeners;return t[e]!==void 0&&t[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const r=t.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}}var Ra=Object.defineProperty,Ta=(l,e,n)=>e in l?Ra(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,Z=(l,e,n)=>(Ta(l,typeof e!="symbol"?e+"":e,n),n);const hn=new os,fr=new cs,Da=Math.cos(70*(Math.PI/180)),pr=(l,e)=>(l%e+e)%e;let ba=class extends Fa{constructor(e,n){super(),Z(this,"object"),Z(this,"domElement"),Z(this,"enabled",!0),Z(this,"target",new $),Z(this,"minDistance",0),Z(this,"maxDistance",1/0),Z(this,"minZoom",0),Z(this,"maxZoom",1/0),Z(this,"minPolarAngle",0),Z(this,"maxPolarAngle",Math.PI),Z(this,"minAzimuthAngle",-1/0),Z(this,"maxAzimuthAngle",1/0),Z(this,"enableDamping",!1),Z(this,"dampingFactor",.05),Z(this,"enableZoom",!0),Z(this,"zoomSpeed",1),Z(this,"enableRotate",!0),Z(this,"rotateSpeed",1),Z(this,"enablePan",!0),Z(this,"panSpeed",1),Z(this,"screenSpacePanning",!0),Z(this,"keyPanSpeed",7),Z(this,"zoomToCursor",!1),Z(this,"autoRotate",!1),Z(this,"autoRotateSpeed",2),Z(this,"reverseOrbit",!1),Z(this,"reverseHorizontalOrbit",!1),Z(this,"reverseVerticalOrbit",!1),Z(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Z(this,"mouseButtons",{LEFT:Rt.ROTATE,MIDDLE:Rt.DOLLY,RIGHT:Rt.PAN}),Z(this,"touches",{ONE:Tt.ROTATE,TWO:Tt.DOLLY_PAN}),Z(this,"target0"),Z(this,"position0"),Z(this,"zoom0"),Z(this,"_domElementKeyEvents",null),Z(this,"getPolarAngle"),Z(this,"getAzimuthalAngle"),Z(this,"setPolarAngle"),Z(this,"setAzimuthalAngle"),Z(this,"getDistance"),Z(this,"getZoomScale"),Z(this,"listenToKeyEvents"),Z(this,"stopListenToKeyEvents"),Z(this,"saveState"),Z(this,"reset"),Z(this,"update"),Z(this,"connect"),Z(this,"dispose"),Z(this,"dollyIn"),Z(this,"dollyOut"),Z(this,"getScale"),Z(this,"setScale"),this.object=e,this.domElement=n,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>d.phi,this.getAzimuthalAngle=()=>d.theta,this.setPolarAngle=m=>{let _=pr(m,2*Math.PI),Q=d.phi;Q<0&&(Q+=2*Math.PI),_<0&&(_+=2*Math.PI);let ae=Math.abs(_-Q);2*Math.PI-ae<ae&&(_<Q?_+=2*Math.PI:Q+=2*Math.PI),h.phi=_-Q,t.update()},this.setAzimuthalAngle=m=>{let _=pr(m,2*Math.PI),Q=d.theta;Q<0&&(Q+=2*Math.PI),_<0&&(_+=2*Math.PI);let ae=Math.abs(_-Q);2*Math.PI-ae<ae&&(_<Q?_+=2*Math.PI:Q+=2*Math.PI),h.theta=_-Q,t.update()},this.getDistance=()=>t.object.position.distanceTo(t.target),this.listenToKeyEvents=m=>{m.addEventListener("keydown",Et),this._domElementKeyEvents=m},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Et),this._domElementKeyEvents=null},this.saveState=()=>{t.target0.copy(t.target),t.position0.copy(t.object.position),t.zoom0=t.object.zoom},this.reset=()=>{t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),t.dispatchEvent(r),t.update(),o=c.NONE},this.update=(()=>{const m=new $,_=new $(0,1,0),Q=new mt().setFromUnitVectors(e.up,_),ae=Q.clone().invert(),O=new $,be=new mt,je=2*Math.PI;return function(){const ln=t.object.position;Q.setFromUnitVectors(e.up,_),ae.copy(Q).invert(),m.copy(ln).sub(t.target),m.applyQuaternion(Q),d.setFromVector3(m),t.autoRotate&&o===c.NONE&&K(V()),t.enableDamping?(d.theta+=h.theta*t.dampingFactor,d.phi+=h.phi*t.dampingFactor):(d.theta+=h.theta,d.phi+=h.phi);let ke=t.minAzimuthAngle,Ke=t.maxAzimuthAngle;isFinite(ke)&&isFinite(Ke)&&(ke<-Math.PI?ke+=je:ke>Math.PI&&(ke-=je),Ke<-Math.PI?Ke+=je:Ke>Math.PI&&(Ke-=je),ke<=Ke?d.theta=Math.max(ke,Math.min(Ke,d.theta)):d.theta=d.theta>(ke+Ke)/2?Math.max(ke,d.theta):Math.min(Ke,d.theta)),d.phi=Math.max(t.minPolarAngle,Math.min(t.maxPolarAngle,d.phi)),d.makeSafe(),t.enableDamping===!0?t.target.addScaledVector(B,t.dampingFactor):t.target.add(B),t.zoomToCursor&&G||t.object.isOrthographicCamera?d.radius=Ce(d.radius):d.radius=Ce(d.radius*f),m.setFromSpherical(d),m.applyQuaternion(ae),ln.copy(t.target).add(m),t.object.matrixAutoUpdate||t.object.updateMatrix(),t.object.lookAt(t.target),t.enableDamping===!0?(h.theta*=1-t.dampingFactor,h.phi*=1-t.dampingFactor,B.multiplyScalar(1-t.dampingFactor)):(h.set(0,0,0),B.set(0,0,0));let ut=!1;if(t.zoomToCursor&&G){let At=null;if(t.object instanceof mn&&t.object.isPerspectiveCamera){const ht=m.length();At=Ce(ht*f);const Ft=ht-At;t.object.position.addScaledVector(x,Ft),t.object.updateMatrixWorld()}else if(t.object.isOrthographicCamera){const ht=new $(y.x,y.y,0);ht.unproject(t.object),t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/f)),t.object.updateProjectionMatrix(),ut=!0;const Ft=new $(y.x,y.y,0);Ft.unproject(t.object),t.object.position.sub(Ft).add(ht),t.object.updateMatrixWorld(),At=m.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),t.zoomToCursor=!1;At!==null&&(t.screenSpacePanning?t.target.set(0,0,-1).transformDirection(t.object.matrix).multiplyScalar(At).add(t.object.position):(hn.origin.copy(t.object.position),hn.direction.set(0,0,-1).transformDirection(t.object.matrix),Math.abs(t.object.up.dot(hn.direction))<Da?e.lookAt(t.target):(fr.setFromNormalAndCoplanarPoint(t.object.up,t.target),hn.intersectPlane(fr,t.target))))}else t.object instanceof Kt&&t.object.isOrthographicCamera&&(ut=f!==1,ut&&(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/f)),t.object.updateProjectionMatrix()));return f=1,G=!1,ut||O.distanceToSquared(t.object.position)>u||8*(1-be.dot(t.object.quaternion))>u?(t.dispatchEvent(r),O.copy(t.object.position),be.copy(t.object.quaternion),ut=!1,!0):!1}})(),this.connect=m=>{t.domElement=m,t.domElement.style.touchAction="none",t.domElement.addEventListener("contextmenu",cn),t.domElement.addEventListener("pointerdown",an),t.domElement.addEventListener("pointercancel",ct),t.domElement.addEventListener("wheel",on)},this.dispose=()=>{var m,_,Q,ae,O,be;t.domElement&&(t.domElement.style.touchAction="auto"),(m=t.domElement)==null||m.removeEventListener("contextmenu",cn),(_=t.domElement)==null||_.removeEventListener("pointerdown",an),(Q=t.domElement)==null||Q.removeEventListener("pointercancel",ct),(ae=t.domElement)==null||ae.removeEventListener("wheel",on),(O=t.domElement)==null||O.ownerDocument.removeEventListener("pointermove",vt),(be=t.domElement)==null||be.ownerDocument.removeEventListener("pointerup",ct),t._domElementKeyEvents!==null&&t._domElementKeyEvents.removeEventListener("keydown",Et)};const t=this,r={type:"change"},s={type:"start"},a={type:"end"},c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=c.NONE;const u=1e-6,d=new or,h=new or;let f=1;const B=new $,C=new _e,v=new _e,g=new _e,T=new _e,R=new _e,H=new _e,w=new _e,b=new _e,M=new _e,x=new $,y=new _e;let G=!1;const U=[],W={};function V(){return 2*Math.PI/60/60*t.autoRotateSpeed}function Y(){return Math.pow(.95,t.zoomSpeed)}function K(m){t.reverseOrbit||t.reverseHorizontalOrbit?h.theta+=m:h.theta-=m}function ne(m){t.reverseOrbit||t.reverseVerticalOrbit?h.phi+=m:h.phi-=m}const z=(()=>{const m=new $;return function(Q,ae){m.setFromMatrixColumn(ae,0),m.multiplyScalar(-Q),B.add(m)}})(),Ie=(()=>{const m=new $;return function(Q,ae){t.screenSpacePanning===!0?m.setFromMatrixColumn(ae,1):(m.setFromMatrixColumn(ae,0),m.crossVectors(t.object.up,m)),m.multiplyScalar(Q),B.add(m)}})(),ve=(()=>{const m=new $;return function(Q,ae){const O=t.domElement;if(O&&t.object instanceof mn&&t.object.isPerspectiveCamera){const be=t.object.position;m.copy(be).sub(t.target);let je=m.length();je*=Math.tan(t.object.fov/2*Math.PI/180),z(2*Q*je/O.clientHeight,t.object.matrix),Ie(2*ae*je/O.clientHeight,t.object.matrix)}else O&&t.object instanceof Kt&&t.object.isOrthographicCamera?(z(Q*(t.object.right-t.object.left)/t.object.zoom/O.clientWidth,t.object.matrix),Ie(ae*(t.object.top-t.object.bottom)/t.object.zoom/O.clientHeight,t.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),t.enablePan=!1)}})();function Fe(m){t.object instanceof mn&&t.object.isPerspectiveCamera||t.object instanceof Kt&&t.object.isOrthographicCamera?f=m:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function se(m){Fe(f/m)}function Ee(m){Fe(f*m)}function ce(m){if(!t.zoomToCursor||!t.domElement)return;G=!0;const _=t.domElement.getBoundingClientRect(),Q=m.clientX-_.left,ae=m.clientY-_.top,O=_.width,be=_.height;y.x=Q/O*2-1,y.y=-(ae/be)*2+1,x.set(y.x,y.y,1).unproject(t.object).sub(t.object.position).normalize()}function Ce(m){return Math.max(t.minDistance,Math.min(t.maxDistance,m))}function Se(m){C.set(m.clientX,m.clientY)}function ot(m){ce(m),w.set(m.clientX,m.clientY)}function ie(m){T.set(m.clientX,m.clientY)}function Je(m){v.set(m.clientX,m.clientY),g.subVectors(v,C).multiplyScalar(t.rotateSpeed);const _=t.domElement;_&&(K(2*Math.PI*g.x/_.clientHeight),ne(2*Math.PI*g.y/_.clientHeight)),C.copy(v),t.update()}function Ne(m){b.set(m.clientX,m.clientY),M.subVectors(b,w),M.y>0?se(Y()):M.y<0&&Ee(Y()),w.copy(b),t.update()}function vn(m){R.set(m.clientX,m.clientY),H.subVectors(R,T).multiplyScalar(t.panSpeed),ve(H.x,H.y),T.copy(R),t.update()}function En(m){ce(m),m.deltaY<0?Ee(Y()):m.deltaY>0&&se(Y()),t.update()}function $t(m){let _=!1;switch(m.code){case t.keys.UP:ve(0,t.keyPanSpeed),_=!0;break;case t.keys.BOTTOM:ve(0,-t.keyPanSpeed),_=!0;break;case t.keys.LEFT:ve(t.keyPanSpeed,0),_=!0;break;case t.keys.RIGHT:ve(-t.keyPanSpeed,0),_=!0;break}_&&(m.preventDefault(),t.update())}function en(){if(U.length==1)C.set(U[0].pageX,U[0].pageY);else{const m=.5*(U[0].pageX+U[1].pageX),_=.5*(U[0].pageY+U[1].pageY);C.set(m,_)}}function _t(){if(U.length==1)T.set(U[0].pageX,U[0].pageY);else{const m=.5*(U[0].pageX+U[1].pageX),_=.5*(U[0].pageY+U[1].pageY);T.set(m,_)}}function Ht(){const m=U[0].pageX-U[1].pageX,_=U[0].pageY-U[1].pageY,Q=Math.sqrt(m*m+_*_);w.set(0,Q)}function tn(){t.enableZoom&&Ht(),t.enablePan&&_t()}function Mn(){t.enableZoom&&Ht(),t.enableRotate&&en()}function nn(m){if(U.length==1)v.set(m.pageX,m.pageY);else{const Q=It(m),ae=.5*(m.pageX+Q.x),O=.5*(m.pageY+Q.y);v.set(ae,O)}g.subVectors(v,C).multiplyScalar(t.rotateSpeed);const _=t.domElement;_&&(K(2*Math.PI*g.x/_.clientHeight),ne(2*Math.PI*g.y/_.clientHeight)),C.copy(v)}function rn(m){if(U.length==1)R.set(m.pageX,m.pageY);else{const _=It(m),Q=.5*(m.pageX+_.x),ae=.5*(m.pageY+_.y);R.set(Q,ae)}H.subVectors(R,T).multiplyScalar(t.panSpeed),ve(H.x,H.y),T.copy(R)}function sn(m){const _=It(m),Q=m.pageX-_.x,ae=m.pageY-_.y,O=Math.sqrt(Q*Q+ae*ae);b.set(0,O),M.set(0,Math.pow(b.y/w.y,t.zoomSpeed)),se(M.y),w.copy(b)}function In(m){t.enableZoom&&sn(m),t.enablePan&&rn(m)}function Fn(m){t.enableZoom&&sn(m),t.enableRotate&&nn(m)}function an(m){var _,Q;t.enabled!==!1&&(U.length===0&&((_=t.domElement)==null||_.ownerDocument.addEventListener("pointermove",vt),(Q=t.domElement)==null||Q.ownerDocument.addEventListener("pointerup",ct)),Dn(m),m.pointerType==="touch"?Mt(m):Lt(m))}function vt(m){t.enabled!==!1&&(m.pointerType==="touch"?Tn(m):Rn(m))}function ct(m){var _,Q,ae;lt(m),U.length===0&&((_=t.domElement)==null||_.releasePointerCapture(m.pointerId),(Q=t.domElement)==null||Q.ownerDocument.removeEventListener("pointermove",vt),(ae=t.domElement)==null||ae.ownerDocument.removeEventListener("pointerup",ct)),t.dispatchEvent(a),o=c.NONE}function Lt(m){let _;switch(m.button){case 0:_=t.mouseButtons.LEFT;break;case 1:_=t.mouseButtons.MIDDLE;break;case 2:_=t.mouseButtons.RIGHT;break;default:_=-1}switch(_){case Rt.DOLLY:if(t.enableZoom===!1)return;ot(m),o=c.DOLLY;break;case Rt.ROTATE:if(m.ctrlKey||m.metaKey||m.shiftKey){if(t.enablePan===!1)return;ie(m),o=c.PAN}else{if(t.enableRotate===!1)return;Se(m),o=c.ROTATE}break;case Rt.PAN:if(m.ctrlKey||m.metaKey||m.shiftKey){if(t.enableRotate===!1)return;Se(m),o=c.ROTATE}else{if(t.enablePan===!1)return;ie(m),o=c.PAN}break;default:o=c.NONE}o!==c.NONE&&t.dispatchEvent(s)}function Rn(m){if(t.enabled!==!1)switch(o){case c.ROTATE:if(t.enableRotate===!1)return;Je(m);break;case c.DOLLY:if(t.enableZoom===!1)return;Ne(m);break;case c.PAN:if(t.enablePan===!1)return;vn(m);break}}function on(m){t.enabled===!1||t.enableZoom===!1||o!==c.NONE&&o!==c.ROTATE||(m.preventDefault(),t.dispatchEvent(s),En(m),t.dispatchEvent(a))}function Et(m){t.enabled===!1||t.enablePan===!1||$t(m)}function Mt(m){switch(Te(m),U.length){case 1:switch(t.touches.ONE){case Tt.ROTATE:if(t.enableRotate===!1)return;en(),o=c.TOUCH_ROTATE;break;case Tt.PAN:if(t.enablePan===!1)return;_t(),o=c.TOUCH_PAN;break;default:o=c.NONE}break;case 2:switch(t.touches.TWO){case Tt.DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;tn(),o=c.TOUCH_DOLLY_PAN;break;case Tt.DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;Mn(),o=c.TOUCH_DOLLY_ROTATE;break;default:o=c.NONE}break;default:o=c.NONE}o!==c.NONE&&t.dispatchEvent(s)}function Tn(m){switch(Te(m),o){case c.TOUCH_ROTATE:if(t.enableRotate===!1)return;nn(m),t.update();break;case c.TOUCH_PAN:if(t.enablePan===!1)return;rn(m),t.update();break;case c.TOUCH_DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;In(m),t.update();break;case c.TOUCH_DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;Fn(m),t.update();break;default:o=c.NONE}}function cn(m){t.enabled!==!1&&m.preventDefault()}function Dn(m){U.push(m)}function lt(m){delete W[m.pointerId];for(let _=0;_<U.length;_++)if(U[_].pointerId==m.pointerId){U.splice(_,1);return}}function Te(m){let _=W[m.pointerId];_===void 0&&(_=new _e,W[m.pointerId]=_),_.set(m.pageX,m.pageY)}function It(m){const _=m.pointerId===U[0].pointerId?U[1]:U[0];return W[_.pointerId]}this.dollyIn=(m=Y())=>{Ee(m),t.update()},this.dollyOut=(m=Y())=>{se(m),t.update()},this.getScale=()=>f,this.setScale=m=>{Fe(m),t.update()},this.getZoomScale=()=>Y(),n!==void 0&&this.connect(n),this.update()}};function gn(l){if(typeof TextDecoder<"u")return new TextDecoder().decode(l);let e="";for(let n=0,t=l.length;n<t;n++)e+=String.fromCharCode(l[n]);try{return decodeURIComponent(escape(e))}catch{return e}}const pt="srgb",et="srgb-linear",mr=3001,ya=3e3;class Vn extends Zn{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new _a(n)}),this.register(function(n){return new Ha(n)}),this.register(function(n){return new Qa(n)}),this.register(function(n){return new ja(n)}),this.register(function(n){return new Xa(n)}),this.register(function(n){return new Oa(n)}),this.register(function(n){return new Ua(n)}),this.register(function(n){return new Pa(n)}),this.register(function(n){return new Ja(n)}),this.register(function(n){return new xa(n)}),this.register(function(n){return new Na(n)}),this.register(function(n){return new La(n)}),this.register(function(n){return new Ka(n)}),this.register(function(n){return new ka(n)}),this.register(function(n){return new wa(n)}),this.register(function(n){return new Za(n)}),this.register(function(n){return new Ya(n)})}load(e,n,t,r){const s=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const u=Qt.extractUrlBase(e);a=Qt.resolveURL(u,this.path)}else a=Qt.extractUrlBase(e);this.manager.itemStart(e);const c=function(u){r?r(u):console.error(u),s.manager.itemError(e),s.manager.itemEnd(e)},o=new it(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(u){try{s.parse(u,a,function(d){n(d),s.manager.itemEnd(e)},c)}catch(d){c(d)}},t,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,t,r){let s;const a={},c={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(gn(new Uint8Array(e.slice(0,4)))===Nr){try{a[te.KHR_BINARY_GLTF]=new Wa(e)}catch(d){r&&r(d);return}s=JSON.parse(a[te.KHR_BINARY_GLTF].content)}else s=JSON.parse(gn(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const o=new ci(s,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});o.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const d=this.pluginCallbacks[u](o);d.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),c[d.name]=d,a[d.name]=!0}if(s.extensionsUsed)for(let u=0;u<s.extensionsUsed.length;++u){const d=s.extensionsUsed[u],h=s.extensionsRequired||[];switch(d){case te.KHR_MATERIALS_UNLIT:a[d]=new Sa;break;case te.KHR_DRACO_MESH_COMPRESSION:a[d]=new za(s,this.dracoLoader);break;case te.KHR_TEXTURE_TRANSFORM:a[d]=new Va;break;case te.KHR_MESH_QUANTIZATION:a[d]=new qa;break;default:h.indexOf(d)>=0&&c[d]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}o.setExtensions(a),o.setPlugins(c),o.parse(t,r)}parseAsync(e,n){const t=this;return new Promise(function(r,s){t.parse(e,n,r,s)})}}function Ga(){let l={};return{get:function(e){return l[e]},add:function(e,n){l[e]=n},remove:function(e){delete l[e]},removeAll:function(){l={}}}}const te={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class wa{constructor(e){this.parser=e,this.name=te.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let t=0,r=n.length;t<r;t++){const s=n[t];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const n=this.parser,t="light:"+e;let r=n.cache.get(t);if(r)return r;const s=n.json,o=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let u;const d=new We(16777215);o.color!==void 0&&d.setRGB(o.color[0],o.color[1],o.color[2],et);const h=o.range!==void 0?o.range:0;switch(o.type){case"directional":u=new As(d),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new us(d),u.distance=h;break;case"spot":u=new ls(d),u.distance=h,o.spot=o.spot||{},o.spot.innerConeAngle=o.spot.innerConeAngle!==void 0?o.spot.innerConeAngle:0,o.spot.outerConeAngle=o.spot.outerConeAngle!==void 0?o.spot.outerConeAngle:Math.PI/4,u.angle=o.spot.outerConeAngle,u.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return u.position.set(0,0,0),u.decay=2,qe(u,o),o.intensity!==void 0&&(u.intensity=o.intensity),u.name=n.createUniqueName(o.name||"light_"+e),r=Promise.resolve(u),n.cache.add(t,r),r}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,t=this.parser,s=t.json.nodes[e],c=(s.extensions&&s.extensions[this.name]||{}).light;return c===void 0?null:this._loadLight(c).then(function(o){return t._getNodeRef(n.cache,c,o)})}}class Sa{constructor(){this.name=te.KHR_MATERIALS_UNLIT}getMaterialType(){return bt}extendParams(e,n,t){const r=[];e.color=new We(1,1,1),e.opacity=1;const s=n.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const a=s.baseColorFactor;e.color.setRGB(a[0],a[1],a[2],et),e.opacity=a[3]}s.baseColorTexture!==void 0&&r.push(t.assignTexture(e,"map",s.baseColorTexture,pt))}return Promise.all(r)}}class xa{constructor(e){this.parser=e,this.name=te.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(n.emissiveIntensity=s),Promise.resolve()}}class _a{constructor(e){this.parser=e,this.name=te.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ze}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];if(a.clearcoatFactor!==void 0&&(n.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&s.push(t.assignTexture(n,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&s.push(t.assignTexture(n,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(s.push(t.assignTexture(n,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const c=a.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new _e(c,c)}return Promise.all(s)}}class Ha{constructor(e){this.parser=e,this.name=te.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ze}extendMaterialParams(e,n){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return n.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class La{constructor(e){this.parser=e,this.name=te.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ze}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return a.iridescenceFactor!==void 0&&(n.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&s.push(t.assignTexture(n,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(n.iridescenceIOR=a.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&s.push(t.assignTexture(n,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}}class Oa{constructor(e){this.parser=e,this.name=te.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ze}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];n.sheenColor=new We(0,0,0),n.sheenRoughness=0,n.sheen=1;const a=r.extensions[this.name];if(a.sheenColorFactor!==void 0){const c=a.sheenColorFactor;n.sheenColor.setRGB(c[0],c[1],c[2],et)}return a.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&s.push(t.assignTexture(n,"sheenColorMap",a.sheenColorTexture,pt)),a.sheenRoughnessTexture!==void 0&&s.push(t.assignTexture(n,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}}class Ua{constructor(e){this.parser=e,this.name=te.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ze}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return a.transmissionFactor!==void 0&&(n.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&s.push(t.assignTexture(n,"transmissionMap",a.transmissionTexture)),Promise.all(s)}}class Pa{constructor(e){this.parser=e,this.name=te.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ze}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];n.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&s.push(t.assignTexture(n,"thicknessMap",a.thicknessTexture)),n.attenuationDistance=a.attenuationDistance||1/0;const c=a.attenuationColor||[1,1,1];return n.attenuationColor=new We().setRGB(c[0],c[1],c[2],et),Promise.all(s)}}class Ja{constructor(e){this.parser=e,this.name=te.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ze}extendMaterialParams(e,n){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return n.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class Na{constructor(e){this.parser=e,this.name=te.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ze}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];n.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&s.push(t.assignTexture(n,"specularIntensityMap",a.specularTexture));const c=a.specularColorFactor||[1,1,1];return n.specularColor=new We().setRGB(c[0],c[1],c[2],et),a.specularColorTexture!==void 0&&s.push(t.assignTexture(n,"specularColorMap",a.specularColorTexture,pt)),Promise.all(s)}}class ka{constructor(e){this.parser=e,this.name=te.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ze}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return n.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&s.push(t.assignTexture(n,"bumpMap",a.bumpTexture)),Promise.all(s)}}class Ka{constructor(e){this.parser=e,this.name=te.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ze}extendMaterialParams(e,n){const t=this.parser,r=t.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return a.anisotropyStrength!==void 0&&(n.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(n.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&s.push(t.assignTexture(n,"anisotropyMap",a.anisotropyTexture)),Promise.all(s)}}class Qa{constructor(e){this.parser=e,this.name=te.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,t=n.json,r=t.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],a=n.options.ktx2Loader;if(!a){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,s.source,a)}}class ja{constructor(e){this.parser=e,this.name=te.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,t=this.parser,r=t.json,s=r.textures[e];if(!s.extensions||!s.extensions[n])return null;const a=s.extensions[n],c=r.images[a.source];let o=t.textureLoader;if(c.uri){const u=t.options.manager.getHandler(c.uri);u!==null&&(o=u)}return this.detectSupport().then(function(u){if(u)return t.loadTextureImage(e,a.source,o);if(r.extensionsRequired&&r.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return t.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Xa{constructor(e){this.parser=e,this.name=te.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,t=this.parser,r=t.json,s=r.textures[e];if(!s.extensions||!s.extensions[n])return null;const a=s.extensions[n],c=r.images[a.source];let o=t.textureLoader;if(c.uri){const u=t.options.manager.getHandler(c.uri);u!==null&&(o=u)}return this.detectSupport().then(function(u){if(u)return t.loadTextureImage(e,a.source,o);if(r.extensionsRequired&&r.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return t.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Za{constructor(e){this.name=te.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,t=n.bufferViews[e];if(t.extensions&&t.extensions[this.name]){const r=t.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(c){const o=r.byteOffset||0,u=r.byteLength||0,d=r.count,h=r.byteStride,f=new Uint8Array(c,o,u);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(d,h,f,r.mode,r.filter).then(function(B){return B.buffer}):a.ready.then(function(){const B=new ArrayBuffer(d*h);return a.decodeGltfBuffer(new Uint8Array(B),d,h,f,r.mode,r.filter),B})})}else return null}}class Ya{constructor(e){this.name=te.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,t=n.nodes[e];if(!t.extensions||!t.extensions[this.name]||t.mesh===void 0)return null;const r=n.meshes[t.mesh];for(const u of r.primitives)if(u.mode!==Ue.TRIANGLES&&u.mode!==Ue.TRIANGLE_STRIP&&u.mode!==Ue.TRIANGLE_FAN&&u.mode!==void 0)return null;const a=t.extensions[this.name].attributes,c=[],o={};for(const u in a)c.push(this.parser.getDependency("accessor",a[u]).then(d=>(o[u]=d,o[u])));return c.length<1?null:(c.push(this.parser.createNodeMesh(e)),Promise.all(c).then(u=>{const d=u.pop(),h=d.isGroup?d.children:[d],f=u[0].count,B=[];for(const C of h){const v=new Bt,g=new $,T=new mt,R=new $(1,1,1),H=new hs(C.geometry,C.material,f);for(let w=0;w<f;w++)o.TRANSLATION&&g.fromBufferAttribute(o.TRANSLATION,w),o.ROTATION&&T.fromBufferAttribute(o.ROTATION,w),o.SCALE&&R.fromBufferAttribute(o.SCALE,w),H.setMatrixAt(w,v.compose(g,T,R));for(const w in o)if(w==="_COLOR_0"){const b=o[w];H.instanceColor=new ds(b.array,b.itemSize,b.normalized)}else w!=="TRANSLATION"&&w!=="ROTATION"&&w!=="SCALE"&&C.geometry.setAttribute(w,o[w]);Tr.prototype.copy.call(H,C),this.parser.assignFinalMaterial(H),B.push(H)}return d.isGroup?(d.clear(),d.add(...B),d):B[0]}))}}const Nr="glTF",Jt=12,Br={JSON:1313821514,BIN:5130562};class Wa{constructor(e){this.name=te.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,Jt);if(this.header={magic:gn(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==Nr)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const t=this.header.length-Jt,r=new DataView(e,Jt);let s=0;for(;s<t;){const a=r.getUint32(s,!0);s+=4;const c=r.getUint32(s,!0);if(s+=4,c===Br.JSON){const o=new Uint8Array(e,Jt+s,a);this.content=gn(o)}else if(c===Br.BIN){const o=Jt+s;this.body=e.slice(o,o+a)}s+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class za{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=te.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const t=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,c={},o={},u={};for(const d in a){const h=jn[d]||d.toLowerCase();c[h]=a[d]}for(const d in e.attributes){const h=jn[d]||d.toLowerCase();if(a[d]!==void 0){const f=t.accessors[e.attributes[d]],B=Gt[f.componentType];u[h]=B.name,o[h]=f.normalized===!0}}return n.getDependency("bufferView",s).then(function(d){return new Promise(function(h,f){r.decodeDracoFile(d,function(B){for(const C in B.attributes){const v=B.attributes[C],g=o[C];g!==void 0&&(v.normalized=g)}h(B)},c,u,et,f)})})}}class Va{constructor(){this.name=te.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}}class qa{constructor(){this.name=te.KHR_MESH_QUANTIZATION}}class kr extends Hs{constructor(e,n,t,r){super(e,n,t,r)}copySampleValue_(e){const n=this.resultBuffer,t=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let a=0;a!==r;a++)n[a]=t[s+a];return n}interpolate_(e,n,t,r){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,o=c*2,u=c*3,d=r-n,h=(t-n)/d,f=h*h,B=f*h,C=e*u,v=C-u,g=-2*B+3*f,T=B-f,R=1-g,H=T-f+h;for(let w=0;w!==c;w++){const b=a[v+w+c],M=a[v+w+o]*d,x=a[C+w+c],y=a[C+w]*d;s[w]=R*b+H*M+g*x+T*y}return s}}const $a=new mt;class ei extends kr{interpolate_(e,n,t,r){const s=super.interpolate_(e,n,t,r);return $a.fromArray(s).normalize().toArray(s),s}}const Ue={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Gt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},gr={9728:Pn,9729:Ge,9984:Cs,9985:gs,9986:Bs,9987:Dr},Cr={33071:$e,33648:vs,10497:Jn},xn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},jn={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...zn>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},rt={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ti={CUBICSPLINE:void 0,LINEAR:Gr,STEP:Ss},_n={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function ni(l){return l.DefaultMaterial===void 0&&(l.DefaultMaterial=new br({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:_s})),l.DefaultMaterial}function ft(l,e,n){for(const t in n.extensions)l[t]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[t]=n.extensions[t])}function qe(l,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(l.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function ri(l,e,n){let t=!1,r=!1,s=!1;for(let u=0,d=e.length;u<d;u++){const h=e[u];if(h.POSITION!==void 0&&(t=!0),h.NORMAL!==void 0&&(r=!0),h.COLOR_0!==void 0&&(s=!0),t&&r&&s)break}if(!t&&!r&&!s)return Promise.resolve(l);const a=[],c=[],o=[];for(let u=0,d=e.length;u<d;u++){const h=e[u];if(t){const f=h.POSITION!==void 0?n.getDependency("accessor",h.POSITION):l.attributes.position;a.push(f)}if(r){const f=h.NORMAL!==void 0?n.getDependency("accessor",h.NORMAL):l.attributes.normal;c.push(f)}if(s){const f=h.COLOR_0!==void 0?n.getDependency("accessor",h.COLOR_0):l.attributes.color;o.push(f)}}return Promise.all([Promise.all(a),Promise.all(c),Promise.all(o)]).then(function(u){const d=u[0],h=u[1],f=u[2];return t&&(l.morphAttributes.position=d),r&&(l.morphAttributes.normal=h),s&&(l.morphAttributes.color=f),l.morphTargetsRelative=!0,l})}function si(l,e){if(l.updateMorphTargets(),e.weights!==void 0)for(let n=0,t=e.weights.length;n<t;n++)l.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(l.morphTargetInfluences.length===n.length){l.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++)l.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ai(l){let e;const n=l.extensions&&l.extensions[te.KHR_DRACO_MESH_COMPRESSION];if(n?e="draco:"+n.bufferView+":"+n.indices+":"+Hn(n.attributes):e=l.indices+":"+Hn(l.attributes)+":"+l.mode,l.targets!==void 0)for(let t=0,r=l.targets.length;t<r;t++)e+=":"+Hn(l.targets[t]);return e}function Hn(l){let e="";const n=Object.keys(l).sort();for(let t=0,r=n.length;t<r;t++)e+=n[t]+":"+l[n[t]]+";";return e}function Xn(l){switch(l){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function ii(l){return l.search(/\.jpe?g($|\?)/i)>0||l.search(/^data\:image\/jpeg/)===0?"image/jpeg":l.search(/\.webp($|\?)/i)>0||l.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const oi=new Bt;class ci{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new Ga,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let t=!1,r=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(t=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||t||r&&s<98?this.textureLoader=new fs(this.options.manager):this.textureLoader=new ps(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new it(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const t=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([t.getDependencies("scene"),t.getDependencies("animation"),t.getDependencies("camera")])}).then(function(a){const c={scene:a[0][r.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:r.asset,parser:t,userData:{}};return ft(s,c,r),qe(c,r),Promise.all(t._invokeAll(function(o){return o.afterRoot&&o.afterRoot(c)})).then(function(){for(const o of c.scenes)o.updateMatrixWorld();e(c)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],t=this.json.meshes||[];for(let r=0,s=n.length;r<s;r++){const a=n[r].joints;for(let c=0,o=a.length;c<o;c++)e[a[c]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const a=e[r];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(t[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,t){if(e.refs[n]<=1)return t;const r=t.clone(),s=(a,c)=>{const o=this.associations.get(a);o!=null&&this.associations.set(c,o);for(const[u,d]of a.children.entries())s(d,c.children[u])};return s(t,r),r.name+="_instance_"+e.uses[n]++,r}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let t=0;t<n.length;t++){const r=e(n[t]);if(r)return r}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const t=[];for(let r=0;r<n.length;r++){const s=e(n[r]);s&&t.push(s)}return t}getDependency(e,n){const t=e+":"+n;let r=this.cache.get(t);if(!r){switch(e){case"scene":r=this.loadScene(n);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(n)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(n)});break;case"accessor":r=this.loadAccessor(n);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(n)});break;case"buffer":r=this.loadBuffer(n);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(n)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(n)});break;case"skin":r=this.loadSkin(n);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(n)});break;case"camera":r=this.loadCamera(n);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,n)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(t,r)}return r}getDependencies(e){let n=this.cache.get(e);if(!n){const t=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(r.map(function(s,a){return t.getDependency(e,a)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],t=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[te.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,a){t.load(Qt.resolveURL(n.uri,r.path),s,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(t){const r=n.byteLength||0,s=n.byteOffset||0;return t.slice(s,s+r)})}loadAccessor(e){const n=this,t=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const a=xn[r.type],c=Gt[r.componentType],o=r.normalized===!0,u=new c(r.count*a);return Promise.resolve(new jt(u,a,o))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(a){const c=a[0],o=xn[r.type],u=Gt[r.componentType],d=u.BYTES_PER_ELEMENT,h=d*o,f=r.byteOffset||0,B=r.bufferView!==void 0?t.bufferViews[r.bufferView].byteStride:void 0,C=r.normalized===!0;let v,g;if(B&&B!==h){const T=Math.floor(f/B),R="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+T+":"+r.count;let H=n.cache.get(R);H||(v=new u(c,T*B,r.count*B/d),H=new ms(v,B/d),n.cache.add(R,H)),g=new xs(H,o,f%B/d,C)}else c===null?v=new u(r.count*o):v=new u(c,f,r.count*o),g=new jt(v,o,C);if(r.sparse!==void 0){const T=xn.SCALAR,R=Gt[r.sparse.indices.componentType],H=r.sparse.indices.byteOffset||0,w=r.sparse.values.byteOffset||0,b=new R(a[1],H,r.sparse.count*T),M=new u(a[2],w,r.sparse.count*o);c!==null&&(g=new jt(g.array.slice(),g.itemSize,g.normalized));for(let x=0,y=b.length;x<y;x++){const G=b[x];if(g.setX(G,M[x*o]),o>=2&&g.setY(G,M[x*o+1]),o>=3&&g.setZ(G,M[x*o+2]),o>=4&&g.setW(G,M[x*o+3]),o>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const n=this.json,t=this.options,s=n.textures[e].source,a=n.images[s];let c=this.textureLoader;if(a.uri){const o=t.manager.getHandler(a.uri);o!==null&&(c=o)}return this.loadTextureImage(e,s,c)}loadTextureImage(e,n,t){const r=this,s=this.json,a=s.textures[e],c=s.images[n],o=(c.uri||c.bufferView)+":"+a.sampler;if(this.textureCache[o])return this.textureCache[o];const u=this.loadImageSource(n,t).then(function(d){d.flipY=!1,d.name=a.name||c.name||"",d.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(d.name=c.uri);const f=(s.samplers||{})[a.sampler]||{};return d.magFilter=gr[f.magFilter]||Ge,d.minFilter=gr[f.minFilter]||Dr,d.wrapS=Cr[f.wrapS]||Jn,d.wrapT=Cr[f.wrapT]||Jn,r.associations.set(d,{textures:e}),d}).catch(function(){return null});return this.textureCache[o]=u,u}loadImageSource(e,n){const t=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(h=>h.clone());const a=r.images[e],c=self.URL||self.webkitURL;let o=a.uri||"",u=!1;if(a.bufferView!==void 0)o=t.getDependency("bufferView",a.bufferView).then(function(h){u=!0;const f=new Blob([h],{type:a.mimeType});return o=c.createObjectURL(f),o});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const d=Promise.resolve(o).then(function(h){return new Promise(function(f,B){let C=f;n.isImageBitmapLoader===!0&&(C=function(v){const g=new st(v);g.needsUpdate=!0,f(g)}),n.load(Qt.resolveURL(h,s.path),C,void 0,B)})}).then(function(h){return u===!0&&c.revokeObjectURL(o),qe(h,a),h.userData.mimeType=a.mimeType||ii(a.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),h});return this.sourceCache[e]=d,d}assignTexture(e,n,t,r){const s=this;return this.getDependency("texture",t.index).then(function(a){if(!a)return null;if(t.texCoord!==void 0&&t.texCoord>0&&(a=a.clone(),a.channel=t.texCoord),s.extensions[te.KHR_TEXTURE_TRANSFORM]){const c=t.extensions!==void 0?t.extensions[te.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const o=s.associations.get(a);a=s.extensions[te.KHR_TEXTURE_TRANSFORM].extendTexture(a,c),s.associations.set(a,o)}}return r!==void 0&&(typeof r=="number"&&(r=r===mr?pt:et),"colorSpace"in a?a.colorSpace=r:a.encoding=r===pt?mr:ya),e[n]=a,a})}assignFinalMaterial(e){const n=e.geometry;let t=e.material;const r=n.attributes.tangent===void 0,s=n.attributes.color!==void 0,a=n.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+t.uuid;let o=this.cache.get(c);o||(o=new Es,bn.prototype.copy.call(o,t),o.color.copy(t.color),o.map=t.map,o.sizeAttenuation=!1,this.cache.add(c,o)),t=o}else if(e.isLine){const c="LineBasicMaterial:"+t.uuid;let o=this.cache.get(c);o||(o=new Ms,bn.prototype.copy.call(o,t),o.color.copy(t.color),o.map=t.map,this.cache.add(c,o)),t=o}if(r||s||a){let c="ClonedMaterial:"+t.uuid+":";r&&(c+="derivative-tangents:"),s&&(c+="vertex-colors:"),a&&(c+="flat-shading:");let o=this.cache.get(c);o||(o=t.clone(),s&&(o.vertexColors=!0),a&&(o.flatShading=!0),r&&(o.normalScale&&(o.normalScale.y*=-1),o.clearcoatNormalScale&&(o.clearcoatNormalScale.y*=-1)),this.cache.add(c,o),this.associations.set(o,this.associations.get(t))),t=o}e.material=t}getMaterialType(){return br}loadMaterial(e){const n=this,t=this.json,r=this.extensions,s=t.materials[e];let a;const c={},o=s.extensions||{},u=[];if(o[te.KHR_MATERIALS_UNLIT]){const h=r[te.KHR_MATERIALS_UNLIT];a=h.getMaterialType(),u.push(h.extendParams(c,s,n))}else{const h=s.pbrMetallicRoughness||{};if(c.color=new We(1,1,1),c.opacity=1,Array.isArray(h.baseColorFactor)){const f=h.baseColorFactor;c.color.setRGB(f[0],f[1],f[2],et),c.opacity=f[3]}h.baseColorTexture!==void 0&&u.push(n.assignTexture(c,"map",h.baseColorTexture,pt)),c.metalness=h.metallicFactor!==void 0?h.metallicFactor:1,c.roughness=h.roughnessFactor!==void 0?h.roughnessFactor:1,h.metallicRoughnessTexture!==void 0&&(u.push(n.assignTexture(c,"metalnessMap",h.metallicRoughnessTexture)),u.push(n.assignTexture(c,"roughnessMap",h.metallicRoughnessTexture))),a=this._invokeOne(function(f){return f.getMaterialType&&f.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(f){return f.extendMaterialParams&&f.extendMaterialParams(e,c)})))}s.doubleSided===!0&&(c.side=Rr);const d=s.alphaMode||_n.OPAQUE;if(d===_n.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,d===_n.MASK&&(c.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&a!==bt&&(u.push(n.assignTexture(c,"normalMap",s.normalTexture)),c.normalScale=new _e(1,1),s.normalTexture.scale!==void 0)){const h=s.normalTexture.scale;c.normalScale.set(h,h)}if(s.occlusionTexture!==void 0&&a!==bt&&(u.push(n.assignTexture(c,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&a!==bt){const h=s.emissiveFactor;c.emissive=new We().setRGB(h[0],h[1],h[2],et)}return s.emissiveTexture!==void 0&&a!==bt&&u.push(n.assignTexture(c,"emissiveMap",s.emissiveTexture,pt)),Promise.all(u).then(function(){const h=new a(c);return s.name&&(h.name=s.name),qe(h,s),n.associations.set(h,{materials:e}),s.extensions&&ft(r,h,s),h})}createUniqueName(e){const n=Is.sanitizeNodeName(e||"");return n in this.nodeNamesUsed?n+"_"+ ++this.nodeNamesUsed[n]:(this.nodeNamesUsed[n]=0,n)}loadGeometries(e){const n=this,t=this.extensions,r=this.primitiveCache;function s(c){return t[te.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,n).then(function(o){return vr(o,c,n)})}const a=[];for(let c=0,o=e.length;c<o;c++){const u=e[c],d=ai(u),h=r[d];if(h)a.push(h.promise);else{let f;u.extensions&&u.extensions[te.KHR_DRACO_MESH_COMPRESSION]?f=s(u):f=vr(new yr,u,n),r[d]={primitive:u,promise:f},a.push(f)}}return Promise.all(a)}loadMesh(e){const n=this,t=this.json,r=this.extensions,s=t.meshes[e],a=s.primitives,c=[];for(let o=0,u=a.length;o<u;o++){const d=a[o].material===void 0?ni(this.cache):this.getDependency("material",a[o].material);c.push(d)}return c.push(n.loadGeometries(a)),Promise.all(c).then(function(o){const u=o.slice(0,o.length-1),d=o[o.length-1],h=[];for(let B=0,C=d.length;B<C;B++){const v=d[B],g=a[B];let T;const R=u[B];if(g.mode===Ue.TRIANGLES||g.mode===Ue.TRIANGLE_STRIP||g.mode===Ue.TRIANGLE_FAN||g.mode===void 0)T=s.isSkinnedMesh===!0?new Fs(v,R):new zt(v,R),T.isSkinnedMesh===!0&&T.normalizeSkinWeights(),g.mode===Ue.TRIANGLE_STRIP?T.geometry=dr(T.geometry,Fr):g.mode===Ue.TRIANGLE_FAN&&(T.geometry=dr(T.geometry,Un));else if(g.mode===Ue.LINES)T=new Rs(v,R);else if(g.mode===Ue.LINE_STRIP)T=new Ts(v,R);else if(g.mode===Ue.LINE_LOOP)T=new Ds(v,R);else if(g.mode===Ue.POINTS)T=new bs(v,R);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(T.geometry.morphAttributes).length>0&&si(T,s),T.name=n.createUniqueName(s.name||"mesh_"+e),qe(T,s),g.extensions&&ft(r,T,g),n.assignFinalMaterial(T),h.push(T)}for(let B=0,C=h.length;B<C;B++)n.associations.set(h[B],{meshes:e,primitives:B});if(h.length===1)return s.extensions&&ft(r,h[0],s),h[0];const f=new yn;s.extensions&&ft(r,f,s),n.associations.set(f,{meshes:e});for(let B=0,C=h.length;B<C;B++)f.add(h[B]);return f})}loadCamera(e){let n;const t=this.json.cameras[e],r=t[t.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return t.type==="perspective"?n=new mn(Xt.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):t.type==="orthographic"&&(n=new Kt(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),t.name&&(n.name=this.createUniqueName(t.name)),qe(n,t),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],t=[];for(let r=0,s=n.joints.length;r<s;r++)t.push(this._loadNodeShallow(n.joints[r]));return n.inverseBindMatrices!==void 0?t.push(this.getDependency("accessor",n.inverseBindMatrices)):t.push(null),Promise.all(t).then(function(r){const s=r.pop(),a=r,c=[],o=[];for(let u=0,d=a.length;u<d;u++){const h=a[u];if(h){c.push(h);const f=new Bt;s!==null&&f.fromArray(s.array,u*16),o.push(f)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[u])}return new ys(c,o)})}loadAnimation(e){const n=this.json,t=this,r=n.animations[e],s=r.name?r.name:"animation_"+e,a=[],c=[],o=[],u=[],d=[];for(let h=0,f=r.channels.length;h<f;h++){const B=r.channels[h],C=r.samplers[B.sampler],v=B.target,g=v.node,T=r.parameters!==void 0?r.parameters[C.input]:C.input,R=r.parameters!==void 0?r.parameters[C.output]:C.output;v.node!==void 0&&(a.push(this.getDependency("node",g)),c.push(this.getDependency("accessor",T)),o.push(this.getDependency("accessor",R)),u.push(C),d.push(v))}return Promise.all([Promise.all(a),Promise.all(c),Promise.all(o),Promise.all(u),Promise.all(d)]).then(function(h){const f=h[0],B=h[1],C=h[2],v=h[3],g=h[4],T=[];for(let R=0,H=f.length;R<H;R++){const w=f[R],b=B[R],M=C[R],x=v[R],y=g[R];if(w===void 0)continue;w.updateMatrix&&w.updateMatrix();const G=t._createAnimationTracks(w,b,M,x,y);if(G)for(let U=0;U<G.length;U++)T.push(G[U])}return new Gs(s,void 0,T)})}createNodeMesh(e){const n=this.json,t=this,r=n.nodes[e];return r.mesh===void 0?null:t.getDependency("mesh",r.mesh).then(function(s){const a=t._getNodeRef(t.meshCache,r.mesh,s);return r.weights!==void 0&&a.traverse(function(c){if(c.isMesh)for(let o=0,u=r.weights.length;o<u;o++)c.morphTargetInfluences[o]=r.weights[o]}),a})}loadNode(e){const n=this.json,t=this,r=n.nodes[e],s=t._loadNodeShallow(e),a=[],c=r.children||[];for(let u=0,d=c.length;u<d;u++)a.push(t.getDependency("node",c[u]));const o=r.skin===void 0?Promise.resolve(null):t.getDependency("skin",r.skin);return Promise.all([s,Promise.all(a),o]).then(function(u){const d=u[0],h=u[1],f=u[2];f!==null&&d.traverse(function(B){B.isSkinnedMesh&&B.bind(f,oi)});for(let B=0,C=h.length;B<C;B++)d.add(h[B]);return d})}_loadNodeShallow(e){const n=this.json,t=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=n.nodes[e],a=s.name?r.createUniqueName(s.name):"",c=[],o=r._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return o&&c.push(o),s.camera!==void 0&&c.push(r.getDependency("camera",s.camera).then(function(u){return r._getNodeRef(r.cameraCache,s.camera,u)})),r._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){c.push(u)}),this.nodeCache[e]=Promise.all(c).then(function(u){let d;if(s.isBone===!0?d=new ws:u.length>1?d=new yn:u.length===1?d=u[0]:d=new Tr,d!==u[0])for(let h=0,f=u.length;h<f;h++)d.add(u[h]);if(s.name&&(d.userData.name=s.name,d.name=a),qe(d,s),s.extensions&&ft(t,d,s),s.matrix!==void 0){const h=new Bt;h.fromArray(s.matrix),d.applyMatrix4(h)}else s.translation!==void 0&&d.position.fromArray(s.translation),s.rotation!==void 0&&d.quaternion.fromArray(s.rotation),s.scale!==void 0&&d.scale.fromArray(s.scale);return r.associations.has(d)||r.associations.set(d,{}),r.associations.get(d).nodes=e,d}),this.nodeCache[e]}loadScene(e){const n=this.extensions,t=this.json.scenes[e],r=this,s=new yn;t.name&&(s.name=r.createUniqueName(t.name)),qe(s,t),t.extensions&&ft(n,s,t);const a=t.nodes||[],c=[];for(let o=0,u=a.length;o<u;o++)c.push(r.getDependency("node",a[o]));return Promise.all(c).then(function(o){for(let d=0,h=o.length;d<h;d++)s.add(o[d]);const u=d=>{const h=new Map;for(const[f,B]of r.associations)(f instanceof bn||f instanceof st)&&h.set(f,B);return d.traverse(f=>{const B=r.associations.get(f);B!=null&&h.set(f,B)}),h};return r.associations=u(s),s})}_createAnimationTracks(e,n,t,r,s){const a=[],c=e.name?e.name:e.uuid,o=[];rt[s.path]===rt.weights?e.traverse(function(f){f.morphTargetInfluences&&o.push(f.name?f.name:f.uuid)}):o.push(c);let u;switch(rt[s.path]){case rt.weights:u=lr;break;case rt.rotation:u=ur;break;case rt.position:case rt.scale:u=cr;break;default:switch(t.itemSize){case 1:u=lr;break;case 2:case 3:default:u=cr;break}break}const d=r.interpolation!==void 0?ti[r.interpolation]:Gr,h=this._getArrayFromAccessor(t);for(let f=0,B=o.length;f<B;f++){const C=new u(o[f]+"."+rt[s.path],n.array,h,d);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(C),a.push(C)}return a}_getArrayFromAccessor(e){let n=e.array;if(e.normalized){const t=Xn(n.constructor),r=new Float32Array(n.length);for(let s=0,a=n.length;s<a;s++)r[s]=n[s]*t;n=r}return n}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(t){const r=this instanceof ur?ei:kr;return new r(this.times,this.values,this.getValueSize()/3,t)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function li(l,e,n){const t=e.attributes,r=new Yn;if(t.POSITION!==void 0){const c=n.json.accessors[t.POSITION],o=c.min,u=c.max;if(o!==void 0&&u!==void 0){if(r.set(new $(o[0],o[1],o[2]),new $(u[0],u[1],u[2])),c.normalized){const d=Xn(Gt[c.componentType]);r.min.multiplyScalar(d),r.max.multiplyScalar(d)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const c=new $,o=new $;for(let u=0,d=s.length;u<d;u++){const h=s[u];if(h.POSITION!==void 0){const f=n.json.accessors[h.POSITION],B=f.min,C=f.max;if(B!==void 0&&C!==void 0){if(o.setX(Math.max(Math.abs(B[0]),Math.abs(C[0]))),o.setY(Math.max(Math.abs(B[1]),Math.abs(C[1]))),o.setZ(Math.max(Math.abs(B[2]),Math.abs(C[2]))),f.normalized){const v=Xn(Gt[f.componentType]);o.multiplyScalar(v)}c.max(o)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(c)}l.boundingBox=r;const a=new wr;r.getCenter(a.center),a.radius=r.min.distanceTo(r.max)/2,l.boundingSphere=a}function vr(l,e,n){const t=e.attributes,r=[];function s(a,c){return n.getDependency("accessor",a).then(function(o){l.setAttribute(c,o)})}for(const a in t){const c=jn[a]||a.toLowerCase();c in l.attributes||r.push(s(t[a],c))}if(e.indices!==void 0&&!l.index){const a=n.getDependency("accessor",e.indices).then(function(c){l.setIndex(c)});r.push(a)}return qe(l,e),li(l,e,n),Promise.all(r).then(function(){return e.targets!==void 0?ri(l,e.targets,n):l})}const ui={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},Ai={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `};class hi extends Sr{constructor(e){super(e),this.type=we}parse(e){const a=function(y,G){switch(y){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(G||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(G||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(G||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(G||""))}},d=`
`,h=function(y,G,U){G=G||1024;let V=y.pos,Y=-1,K=0,ne="",z=String.fromCharCode.apply(null,new Uint16Array(y.subarray(V,V+128)));for(;0>(Y=z.indexOf(d))&&K<G&&V<y.byteLength;)ne+=z,K+=z.length,V+=128,z+=String.fromCharCode.apply(null,new Uint16Array(y.subarray(V,V+128)));return-1<Y?(y.pos+=K+Y+1,ne+z.slice(0,Y)):!1},f=function(y){const G=/^#\?(\S+)/,U=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,W=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,V=/^\s*FORMAT=(\S+)\s*$/,Y=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,K={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let ne,z;for((y.pos>=y.byteLength||!(ne=h(y)))&&a(1,"no header found"),(z=ne.match(G))||a(3,"bad initial token"),K.valid|=1,K.programtype=z[1],K.string+=ne+`
`;ne=h(y),ne!==!1;){if(K.string+=ne+`
`,ne.charAt(0)==="#"){K.comments+=ne+`
`;continue}if((z=ne.match(U))&&(K.gamma=parseFloat(z[1])),(z=ne.match(W))&&(K.exposure=parseFloat(z[1])),(z=ne.match(V))&&(K.valid|=2,K.format=z[1]),(z=ne.match(Y))&&(K.valid|=4,K.height=parseInt(z[1],10),K.width=parseInt(z[2],10)),K.valid&2&&K.valid&4)break}return K.valid&2||a(3,"missing format specifier"),K.valid&4||a(3,"missing image size specifier"),K},B=function(y,G,U){const W=G;if(W<8||W>32767||y[0]!==2||y[1]!==2||y[2]&128)return new Uint8Array(y);W!==(y[2]<<8|y[3])&&a(3,"wrong scanline width");const V=new Uint8Array(4*G*U);V.length||a(4,"unable to allocate buffer space");let Y=0,K=0;const ne=4*W,z=new Uint8Array(4),Ie=new Uint8Array(ne);let ve=U;for(;ve>0&&K<y.byteLength;){K+4>y.byteLength&&a(1),z[0]=y[K++],z[1]=y[K++],z[2]=y[K++],z[3]=y[K++],(z[0]!=2||z[1]!=2||(z[2]<<8|z[3])!=W)&&a(3,"bad rgbe scanline format");let Fe=0,se;for(;Fe<ne&&K<y.byteLength;){se=y[K++];const ce=se>128;if(ce&&(se-=128),(se===0||Fe+se>ne)&&a(3,"bad scanline data"),ce){const Ce=y[K++];for(let Se=0;Se<se;Se++)Ie[Fe++]=Ce}else Ie.set(y.subarray(K,K+se),Fe),Fe+=se,K+=se}const Ee=W;for(let ce=0;ce<Ee;ce++){let Ce=0;V[Y]=Ie[ce+Ce],Ce+=W,V[Y+1]=Ie[ce+Ce],Ce+=W,V[Y+2]=Ie[ce+Ce],Ce+=W,V[Y+3]=Ie[ce+Ce],Y+=4}ve--}return V},C=function(y,G,U,W){const V=y[G+3],Y=Math.pow(2,V-128)/255;U[W+0]=y[G+0]*Y,U[W+1]=y[G+1]*Y,U[W+2]=y[G+2]*Y,U[W+3]=1},v=function(y,G,U,W){const V=y[G+3],Y=Math.pow(2,V-128)/255;U[W+0]=yt.toHalfFloat(Math.min(y[G+0]*Y,65504)),U[W+1]=yt.toHalfFloat(Math.min(y[G+1]*Y,65504)),U[W+2]=yt.toHalfFloat(Math.min(y[G+2]*Y,65504)),U[W+3]=yt.toHalfFloat(1)},g=new Uint8Array(e);g.pos=0;const T=f(g),R=T.width,H=T.height,w=B(g.subarray(g.pos),R,H);let b,M,x;switch(this.type){case Ye:x=w.length/4;const y=new Float32Array(x*4);for(let U=0;U<x;U++)C(w,U*4,y,U*4);b=y,M=Ye;break;case we:x=w.length/4;const G=new Uint16Array(x*4);for(let U=0;U<x;U++)v(w,U*4,G,U*4);b=G,M=we;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:R,height:H,data:b,header:T.string,gamma:T.gamma,exposure:T.exposure,type:M}}setDataType(e){return this.type=e,this}load(e,n,t,r){function s(a,c){switch(a.type){case Ye:case we:"colorSpace"in a?a.colorSpace="srgb-linear":a.encoding=3e3,a.minFilter=Ge,a.magFilter=Ge,a.generateMipmaps=!1,a.flipY=!0;break}n&&n(a,c)}return super.load(e,s,t,r)}}const Nt=zn>=152;class di extends Sr{constructor(e){super(e),this.type=we}parse(e){const G=Math.pow(2.7182818,2.2);function U(i,A){for(var p=0,E=0;E<65536;++E)(E==0||i[E>>3]&1<<(E&7))&&(A[p++]=E);for(var I=p-1;p<65536;)A[p++]=0;return I}function W(i){for(var A=0;A<16384;A++)i[A]={},i[A].len=0,i[A].lit=0,i[A].p=null}const V={l:0,c:0,lc:0};function Y(i,A,p,E,I){for(;p<i;)A=A<<8|It(E,I),p+=8;p-=i,V.l=A>>p&(1<<i)-1,V.c=A,V.lc=p}const K=new Array(59);function ne(i){for(var A=0;A<=58;++A)K[A]=0;for(var A=0;A<65537;++A)K[i[A]]+=1;for(var p=0,A=58;A>0;--A){var E=p+K[A]>>1;K[A]=p,p=E}for(var A=0;A<65537;++A){var I=i[A];I>0&&(i[A]=I|K[I]++<<6)}}function z(i,A,p,E,I,F,L){for(var S=p,N=0,J=0;I<=F;I++){if(S.value-p.value>E)return!1;Y(6,N,J,i,S);var k=V.l;if(N=V.c,J=V.lc,L[I]=k,k==63){if(S.value-p.value>E)throw"Something wrong with hufUnpackEncTable";Y(8,N,J,i,S);var P=V.l+6;if(N=V.c,J=V.lc,I+P>F+1)throw"Something wrong with hufUnpackEncTable";for(;P--;)L[I++]=0;I--}else if(k>=59){var P=k-59+2;if(I+P>F+1)throw"Something wrong with hufUnpackEncTable";for(;P--;)L[I++]=0;I--}}ne(L)}function Ie(i){return i&63}function ve(i){return i>>6}function Fe(i,A,p,E){for(;A<=p;A++){var I=ve(i[A]),F=Ie(i[A]);if(I>>F)throw"Invalid table entry";if(F>14){var L=E[I>>F-14];if(L.len)throw"Invalid table entry";if(L.lit++,L.p){var S=L.p;L.p=new Array(L.lit);for(var N=0;N<L.lit-1;++N)L.p[N]=S[N]}else L.p=new Array(1);L.p[L.lit-1]=A}else if(F)for(var J=0,N=1<<14-F;N>0;N--){var L=E[(I<<14-F)+J];if(L.len||L.p)throw"Invalid table entry";L.len=F,L.lit=A,J++}}return!0}const se={c:0,lc:0};function Ee(i,A,p,E){i=i<<8|It(p,E),A+=8,se.c=i,se.lc=A}const ce={c:0,lc:0};function Ce(i,A,p,E,I,F,L,S,N,J){if(i==A){E<8&&(Ee(p,E,I,L),p=se.c,E=se.lc),E-=8;var k=p>>E,k=new Uint8Array([k])[0];if(N.value+k>J)return!1;for(var P=S[N.value-1];k-- >0;)S[N.value++]=P}else if(N.value<J)S[N.value++]=i;else return!1;ce.c=p,ce.lc=E}function Se(i){return i&65535}function ot(i){var A=Se(i);return A>32767?A-65536:A}const ie={a:0,b:0};function Je(i,A){var p=ot(i),E=ot(A),I=E,F=p+(I&1)+(I>>1),L=F,S=F-I;ie.a=L,ie.b=S}function Ne(i,A){var p=Se(i),E=Se(A),I=p-(E>>1)&65535,F=E+I-32768&65535;ie.a=F,ie.b=I}function vn(i,A,p,E,I,F,L){for(var S=L<16384,N=p>I?I:p,J=1,k;J<=N;)J<<=1;for(J>>=1,k=J,J>>=1;J>=1;){for(var P=0,ge=P+F*(I-k),j=F*J,X=F*k,q=E*J,ee=E*k,le,Ae,Me,ye;P<=ge;P+=X){for(var he=P,Xe=P+E*(p-k);he<=Xe;he+=ee){var fe=he+q,Re=he+j,Ve=Re+q;S?(Je(i[he+A],i[Re+A]),le=ie.a,Me=ie.b,Je(i[fe+A],i[Ve+A]),Ae=ie.a,ye=ie.b,Je(le,Ae),i[he+A]=ie.a,i[fe+A]=ie.b,Je(Me,ye),i[Re+A]=ie.a,i[Ve+A]=ie.b):(Ne(i[he+A],i[Re+A]),le=ie.a,Me=ie.b,Ne(i[fe+A],i[Ve+A]),Ae=ie.a,ye=ie.b,Ne(le,Ae),i[he+A]=ie.a,i[fe+A]=ie.b,Ne(Me,ye),i[Re+A]=ie.a,i[Ve+A]=ie.b)}if(p&J){var Re=he+j;S?Je(i[he+A],i[Re+A]):Ne(i[he+A],i[Re+A]),le=ie.a,i[Re+A]=ie.b,i[he+A]=le}}if(I&J)for(var he=P,Xe=P+E*(p-k);he<=Xe;he+=ee){var fe=he+q;S?Je(i[he+A],i[fe+A]):Ne(i[he+A],i[fe+A]),le=ie.a,i[fe+A]=ie.b,i[he+A]=le}k=J,J>>=1}return P}function En(i,A,p,E,I,F,L,S,N,J){for(var k=0,P=0,ge=S,j=Math.trunc(I.value+(F+7)/8);I.value<j;)for(Ee(k,P,p,I),k=se.c,P=se.lc;P>=14;){var X=k>>P-14&16383,q=A[X];if(q.len)P-=q.len,Ce(q.lit,L,k,P,p,E,I,N,J,ge),k=ce.c,P=ce.lc;else{if(!q.p)throw"hufDecode issues";var ee;for(ee=0;ee<q.lit;ee++){for(var le=Ie(i[q.p[ee]]);P<le&&I.value<j;)Ee(k,P,p,I),k=se.c,P=se.lc;if(P>=le&&ve(i[q.p[ee]])==(k>>P-le&(1<<le)-1)){P-=le,Ce(q.p[ee],L,k,P,p,E,I,N,J,ge),k=ce.c,P=ce.lc;break}}if(ee==q.lit)throw"hufDecode issues"}}var Ae=8-F&7;for(k>>=Ae,P-=Ae;P>0;){var q=A[k<<14-P&16383];if(q.len)P-=q.len,Ce(q.lit,L,k,P,p,E,I,N,J,ge),k=ce.c,P=ce.lc;else throw"hufDecode issues"}return!0}function $t(i,A,p,E,I,F){var L={value:0},S=p.value,N=Te(A,p),J=Te(A,p);p.value+=4;var k=Te(A,p);if(p.value+=4,N<0||N>=65537||J<0||J>=65537)throw"Something wrong with HUF_ENCSIZE";var P=new Array(65537),ge=new Array(16384);W(ge);var j=E-(p.value-S);if(z(i,A,p,j,N,J,P),k>8*(E-(p.value-S)))throw"Something wrong with hufUncompress";Fe(P,N,J,ge),En(P,ge,i,A,p,k,J,F,I,L)}function en(i,A,p){for(var E=0;E<p;++E)A[E]=i[A[E]]}function _t(i){for(var A=1;A<i.length;A++){var p=i[A-1]+i[A]-128;i[A]=p}}function Ht(i,A){for(var p=0,E=Math.floor((i.length+1)/2),I=0,F=i.length-1;!(I>F||(A[I++]=i[p++],I>F));)A[I++]=i[E++]}function tn(i){for(var A=i.byteLength,p=new Array,E=0,I=new DataView(i);A>0;){var F=I.getInt8(E++);if(F<0){var L=-F;A-=L+1;for(var S=0;S<L;S++)p.push(I.getUint8(E++))}else{var L=F;A-=2;for(var N=I.getUint8(E++),S=0;S<L+1;S++)p.push(N)}}return p}function Mn(i,A,p,E,I,F){var fe=new DataView(F.buffer),L=p[i.idx[0]].width,S=p[i.idx[0]].height,N=3,J=Math.floor(L/8),k=Math.ceil(L/8),P=Math.ceil(S/8),ge=L-(k-1)*8,j=S-(P-1)*8,X={value:0},q=new Array(N),ee=new Array(N),le=new Array(N),Ae=new Array(N),Me=new Array(N);for(let ue=0;ue<N;++ue)Me[ue]=A[i.idx[ue]],q[ue]=ue<1?0:q[ue-1]+k*P,ee[ue]=new Float32Array(64),le[ue]=new Uint16Array(64),Ae[ue]=new Uint16Array(k*64);for(let ue=0;ue<P;++ue){var ye=8;ue==P-1&&(ye=j);var he=8;for(let Be=0;Be<k;++Be){Be==k-1&&(he=ge);for(let oe=0;oe<N;++oe)le[oe].fill(0),le[oe][0]=I[q[oe]++],nn(X,E,le[oe]),rn(le[oe],ee[oe]),sn(ee[oe]);In(ee);for(let oe=0;oe<N;++oe)Fn(ee[oe],Ae[oe],Be*64)}let De=0;for(let Be=0;Be<N;++Be){const oe=p[i.idx[Be]].type;for(let Le=8*ue;Le<8*ue+ye;++Le){De=Me[Be][Le];for(let dt=0;dt<J;++dt){const xe=dt*64+(Le&7)*8;fe.setUint16(De+0*2*oe,Ae[Be][xe+0],!0),fe.setUint16(De+1*2*oe,Ae[Be][xe+1],!0),fe.setUint16(De+2*2*oe,Ae[Be][xe+2],!0),fe.setUint16(De+3*2*oe,Ae[Be][xe+3],!0),fe.setUint16(De+4*2*oe,Ae[Be][xe+4],!0),fe.setUint16(De+5*2*oe,Ae[Be][xe+5],!0),fe.setUint16(De+6*2*oe,Ae[Be][xe+6],!0),fe.setUint16(De+7*2*oe,Ae[Be][xe+7],!0),De+=8*2*oe}}if(J!=k)for(let Le=8*ue;Le<8*ue+ye;++Le){const dt=Me[Be][Le]+8*J*2*oe,xe=J*64+(Le&7)*8;for(let tt=0;tt<he;++tt)fe.setUint16(dt+tt*2*oe,Ae[Be][xe+tt],!0)}}}for(var Xe=new Uint16Array(L),fe=new DataView(F.buffer),Re=0;Re<N;++Re){p[i.idx[Re]].decoded=!0;var Ve=p[i.idx[Re]].type;if(p[Re].type==2)for(var Pt=0;Pt<S;++Pt){const ue=Me[Re][Pt];for(var He=0;He<L;++He)Xe[He]=fe.getUint16(ue+He*2*Ve,!0);for(var He=0;He<L;++He)fe.setFloat32(ue+He*2*Ve,O(Xe[He]),!0)}}}function nn(i,A,p){for(var E,I=1;I<64;)E=A[i.value],E==65280?I=64:E>>8==255?I+=E&255:(p[I]=E,I++),i.value++}function rn(i,A){A[0]=O(i[0]),A[1]=O(i[1]),A[2]=O(i[5]),A[3]=O(i[6]),A[4]=O(i[14]),A[5]=O(i[15]),A[6]=O(i[27]),A[7]=O(i[28]),A[8]=O(i[2]),A[9]=O(i[4]),A[10]=O(i[7]),A[11]=O(i[13]),A[12]=O(i[16]),A[13]=O(i[26]),A[14]=O(i[29]),A[15]=O(i[42]),A[16]=O(i[3]),A[17]=O(i[8]),A[18]=O(i[12]),A[19]=O(i[17]),A[20]=O(i[25]),A[21]=O(i[30]),A[22]=O(i[41]),A[23]=O(i[43]),A[24]=O(i[9]),A[25]=O(i[11]),A[26]=O(i[18]),A[27]=O(i[24]),A[28]=O(i[31]),A[29]=O(i[40]),A[30]=O(i[44]),A[31]=O(i[53]),A[32]=O(i[10]),A[33]=O(i[19]),A[34]=O(i[23]),A[35]=O(i[32]),A[36]=O(i[39]),A[37]=O(i[45]),A[38]=O(i[52]),A[39]=O(i[54]),A[40]=O(i[20]),A[41]=O(i[22]),A[42]=O(i[33]),A[43]=O(i[38]),A[44]=O(i[46]),A[45]=O(i[51]),A[46]=O(i[55]),A[47]=O(i[60]),A[48]=O(i[21]),A[49]=O(i[34]),A[50]=O(i[37]),A[51]=O(i[47]),A[52]=O(i[50]),A[53]=O(i[56]),A[54]=O(i[59]),A[55]=O(i[61]),A[56]=O(i[35]),A[57]=O(i[36]),A[58]=O(i[48]),A[59]=O(i[49]),A[60]=O(i[57]),A[61]=O(i[58]),A[62]=O(i[62]),A[63]=O(i[63])}function sn(i){const A=.5*Math.cos(.7853975),p=.5*Math.cos(3.14159/16),E=.5*Math.cos(3.14159/8),I=.5*Math.cos(3*3.14159/16),F=.5*Math.cos(5*3.14159/16),L=.5*Math.cos(3*3.14159/8),S=.5*Math.cos(7*3.14159/16);for(var N=new Array(4),J=new Array(4),k=new Array(4),P=new Array(4),ge=0;ge<8;++ge){var j=ge*8;N[0]=E*i[j+2],N[1]=L*i[j+2],N[2]=E*i[j+6],N[3]=L*i[j+6],J[0]=p*i[j+1]+I*i[j+3]+F*i[j+5]+S*i[j+7],J[1]=I*i[j+1]-S*i[j+3]-p*i[j+5]-F*i[j+7],J[2]=F*i[j+1]-p*i[j+3]+S*i[j+5]+I*i[j+7],J[3]=S*i[j+1]-F*i[j+3]+I*i[j+5]-p*i[j+7],k[0]=A*(i[j+0]+i[j+4]),k[3]=A*(i[j+0]-i[j+4]),k[1]=N[0]+N[3],k[2]=N[1]-N[2],P[0]=k[0]+k[1],P[1]=k[3]+k[2],P[2]=k[3]-k[2],P[3]=k[0]-k[1],i[j+0]=P[0]+J[0],i[j+1]=P[1]+J[1],i[j+2]=P[2]+J[2],i[j+3]=P[3]+J[3],i[j+4]=P[3]-J[3],i[j+5]=P[2]-J[2],i[j+6]=P[1]-J[1],i[j+7]=P[0]-J[0]}for(var X=0;X<8;++X)N[0]=E*i[16+X],N[1]=L*i[16+X],N[2]=E*i[48+X],N[3]=L*i[48+X],J[0]=p*i[8+X]+I*i[24+X]+F*i[40+X]+S*i[56+X],J[1]=I*i[8+X]-S*i[24+X]-p*i[40+X]-F*i[56+X],J[2]=F*i[8+X]-p*i[24+X]+S*i[40+X]+I*i[56+X],J[3]=S*i[8+X]-F*i[24+X]+I*i[40+X]-p*i[56+X],k[0]=A*(i[X]+i[32+X]),k[3]=A*(i[X]-i[32+X]),k[1]=N[0]+N[3],k[2]=N[1]-N[2],P[0]=k[0]+k[1],P[1]=k[3]+k[2],P[2]=k[3]-k[2],P[3]=k[0]-k[1],i[0+X]=P[0]+J[0],i[8+X]=P[1]+J[1],i[16+X]=P[2]+J[2],i[24+X]=P[3]+J[3],i[32+X]=P[3]-J[3],i[40+X]=P[2]-J[2],i[48+X]=P[1]-J[1],i[56+X]=P[0]-J[0]}function In(i){for(var A=0;A<64;++A){var p=i[0][A],E=i[1][A],I=i[2][A];i[0][A]=p+1.5747*I,i[1][A]=p-.1873*E-.4682*I,i[2][A]=p+1.8556*E}}function Fn(i,A,p){for(var E=0;E<64;++E)A[p+E]=yt.toHalfFloat(an(i[E]))}function an(i){return i<=1?Math.sign(i)*Math.pow(Math.abs(i),2.2):Math.sign(i)*Math.pow(G,Math.abs(i)-1)}function vt(i){return new DataView(i.array.buffer,i.offset.value,i.size)}function ct(i){var A=i.viewer.buffer.slice(i.offset.value,i.offset.value+i.size),p=new Uint8Array(tn(A)),E=new Uint8Array(p.length);return _t(p),Ht(p,E),new DataView(E.buffer)}function Lt(i){var A=i.array.slice(i.offset.value,i.offset.value+i.size),p=An(A),E=new Uint8Array(p.length);return _t(p),Ht(p,E),new DataView(E.buffer)}function Rn(i){for(var A=i.viewer,p={value:i.offset.value},E=new Uint16Array(i.width*i.scanlineBlockSize*(i.channels*i.type)),I=new Uint8Array(8192),F=0,L=new Array(i.channels),S=0;S<i.channels;S++)L[S]={},L[S].start=F,L[S].end=L[S].start,L[S].nx=i.width,L[S].ny=i.lines,L[S].size=i.type,F+=L[S].nx*L[S].ny*L[S].size;var N=be(A,p),J=be(A,p);if(J>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(N<=J)for(var S=0;S<J-N+1;S++)I[S+N]=m(A,p);var k=new Uint16Array(65536),P=U(I,k),ge=Te(A,p);$t(i.array,A,p,ge,E,F);for(var S=0;S<i.channels;++S)for(var j=L[S],X=0;X<L[S].size;++X)vn(E,j.start+X,j.nx,j.size,j.ny,j.nx*j.size,P);en(k,E,F);for(var q=0,ee=new Uint8Array(E.buffer.byteLength),le=0;le<i.lines;le++)for(var Ae=0;Ae<i.channels;Ae++){var j=L[Ae],Me=j.nx*j.size,ye=new Uint8Array(E.buffer,j.end*2,Me*2);ee.set(ye,q),q+=Me*2,j.end+=Me}return new DataView(ee.buffer)}function on(i){var A=i.array.slice(i.offset.value,i.offset.value+i.size),p=An(A);const E=i.lines*i.channels*i.width,I=i.type==1?new Uint16Array(E):new Uint32Array(E);let F=0,L=0;const S=new Array(4);for(let N=0;N<i.lines;N++)for(let J=0;J<i.channels;J++){let k=0;switch(i.type){case 1:S[0]=F,S[1]=S[0]+i.width,F=S[1]+i.width;for(let P=0;P<i.width;++P){const ge=p[S[0]++]<<8|p[S[1]++];k+=ge,I[L]=k,L++}break;case 2:S[0]=F,S[1]=S[0]+i.width,S[2]=S[1]+i.width,F=S[2]+i.width;for(let P=0;P<i.width;++P){const ge=p[S[0]++]<<24|p[S[1]++]<<16|p[S[2]++]<<8;k+=ge,I[L]=k,L++}break}}return new DataView(I.buffer)}function Et(i){var A=i.viewer,p={value:i.offset.value},E=new Uint8Array(i.width*i.lines*(i.channels*i.type*2)),I={version:_(A,p),unknownUncompressedSize:_(A,p),unknownCompressedSize:_(A,p),acCompressedSize:_(A,p),dcCompressedSize:_(A,p),rleCompressedSize:_(A,p),rleUncompressedSize:_(A,p),rleRawSize:_(A,p),totalAcUncompressedCount:_(A,p),totalDcUncompressedCount:_(A,p),acCompression:_(A,p)};if(I.version<2)throw"EXRLoader.parse: "+Ut.compression+" version "+I.version+" is unsupported";for(var F=new Array,L=be(A,p)-2;L>0;){var S=Mt(A.buffer,p),N=m(A,p),J=N>>2&3,k=(N>>4)-1,P=new Int8Array([k])[0],ge=m(A,p);F.push({name:S,index:P,type:ge,compression:J}),L-=S.length+3}for(var j=Ut.channels,X=new Array(i.channels),q=0;q<i.channels;++q){var ee=X[q]={},le=j[q];ee.name=le.name,ee.compression=0,ee.decoded=!1,ee.type=le.pixelType,ee.pLinear=le.pLinear,ee.width=i.width,ee.height=i.lines}for(var Ae={idx:new Array(3)},Me=0;Me<i.channels;++Me)for(var ee=X[Me],q=0;q<F.length;++q){var ye=F[q];ee.name==ye.name&&(ee.compression=ye.compression,ye.index>=0&&(Ae.idx[ye.index]=Me),ee.offset=Me)}if(I.acCompressedSize>0)switch(I.acCompression){case 0:var fe=new Uint16Array(I.totalAcUncompressedCount);$t(i.array,A,p,I.acCompressedSize,fe,I.totalAcUncompressedCount);break;case 1:var he=i.array.slice(p.value,p.value+I.totalAcUncompressedCount),Xe=An(he),fe=new Uint16Array(Xe.buffer);p.value+=I.totalAcUncompressedCount;break}if(I.dcCompressedSize>0){var Re={array:i.array,offset:p,size:I.dcCompressedSize},Ve=new Uint16Array(Lt(Re).buffer);p.value+=I.dcCompressedSize}if(I.rleRawSize>0){var he=i.array.slice(p.value,p.value+I.rleCompressedSize),Xe=An(he),Pt=tn(Xe.buffer);p.value+=I.rleCompressedSize}for(var He=0,ue=new Array(X.length),q=0;q<ue.length;++q)ue[q]=new Array;for(var De=0;De<i.lines;++De)for(var Be=0;Be<X.length;++Be)ue[Be].push(He),He+=X[Be].width*i.type*2;Mn(Ae,ue,X,fe,Ve,E);for(var q=0;q<X.length;++q){var ee=X[q];if(!ee.decoded)switch(ee.compression){case 2:for(var oe=0,Le=0,De=0;De<i.lines;++De){for(var dt=ue[q][oe],xe=0;xe<ee.width;++xe){for(var tt=0;tt<2*ee.type;++tt)E[dt++]=Pt[Le+tt*ee.width*ee.height];Le++}oe++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(E.buffer)}function Mt(i,A){for(var p=new Uint8Array(i),E=0;p[A.value+E]!=0;)E+=1;var I=new TextDecoder().decode(p.slice(A.value,A.value+E));return A.value=A.value+E+1,I}function Tn(i,A,p){var E=new TextDecoder().decode(new Uint8Array(i).slice(A.value,A.value+p));return A.value=A.value+p,E}function cn(i,A){var p=lt(i,A),E=Te(i,A);return[p,E]}function Dn(i,A){var p=Te(i,A),E=Te(i,A);return[p,E]}function lt(i,A){var p=i.getInt32(A.value,!0);return A.value=A.value+4,p}function Te(i,A){var p=i.getUint32(A.value,!0);return A.value=A.value+4,p}function It(i,A){var p=i[A.value];return A.value=A.value+1,p}function m(i,A){var p=i.getUint8(A.value);return A.value=A.value+1,p}const _=function(i,A){let p;return"getBigInt64"in DataView.prototype?p=Number(i.getBigInt64(A.value,!0)):p=i.getUint32(A.value+4,!0)+Number(i.getUint32(A.value,!0)<<32),A.value+=8,p};function Q(i,A){var p=i.getFloat32(A.value,!0);return A.value+=4,p}function ae(i,A){return yt.toHalfFloat(Q(i,A))}function O(i){var A=(i&31744)>>10,p=i&1023;return(i>>15?-1:1)*(A?A===31?p?NaN:1/0:Math.pow(2,A-15)*(1+p/1024):6103515625e-14*(p/1024))}function be(i,A){var p=i.getUint16(A.value,!0);return A.value+=2,p}function je(i,A){return O(be(i,A))}function ar(i,A,p,E){for(var I=p.value,F=[];p.value<I+E-1;){var L=Mt(A,p),S=lt(i,p),N=m(i,p);p.value+=3;var J=lt(i,p),k=lt(i,p);F.push({name:L,pixelType:S,pLinear:N,xSampling:J,ySampling:k})}return p.value+=1,F}function ln(i,A){var p=Q(i,A),E=Q(i,A),I=Q(i,A),F=Q(i,A),L=Q(i,A),S=Q(i,A),N=Q(i,A),J=Q(i,A);return{redX:p,redY:E,greenX:I,greenY:F,blueX:L,blueY:S,whiteX:N,whiteY:J}}function ke(i,A){var p=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],E=m(i,A);return p[E]}function Ke(i,A){var p=Te(i,A),E=Te(i,A),I=Te(i,A),F=Te(i,A);return{xMin:p,yMin:E,xMax:I,yMax:F}}function ut(i,A){var p=["INCREASING_Y"],E=m(i,A);return p[E]}function At(i,A){var p=Q(i,A),E=Q(i,A);return[p,E]}function ht(i,A){var p=Q(i,A),E=Q(i,A),I=Q(i,A);return[p,E,I]}function Ft(i,A,p,E,I){if(E==="string"||E==="stringvector"||E==="iccProfile")return Tn(A,p,I);if(E==="chlist")return ar(i,A,p,I);if(E==="chromaticities")return ln(i,p);if(E==="compression")return ke(i,p);if(E==="box2i")return Ke(i,p);if(E==="lineOrder")return ut(i,p);if(E==="float")return Q(i,p);if(E==="v2f")return At(i,p);if(E==="v3f")return ht(i,p);if(E==="int")return lt(i,p);if(E==="rational")return cn(i,p);if(E==="timecode")return Dn(i,p);if(E==="preview")return p.value+=I,"skipped";p.value+=I}function ts(i,A,p){const E={};if(i.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";E.version=i.getUint8(4);const I=i.getUint8(5);E.spec={singleTile:!!(I&2),longName:!!(I&4),deepFormat:!!(I&8),multiPart:!!(I&16)},p.value=8;for(var F=!0;F;){var L=Mt(A,p);if(L==0)F=!1;else{var S=Mt(A,p),N=Te(i,p),J=Ft(i,A,p,S,N);J===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${S}'.`):E[L]=J}}if(I&-5)throw console.error("EXRHeader:",E),"THREE.EXRLoader: provided file is currently unsupported.";return E}function ns(i,A,p,E,I){const F={size:0,viewer:A,array:p,offset:E,width:i.dataWindow.xMax-i.dataWindow.xMin+1,height:i.dataWindow.yMax-i.dataWindow.yMin+1,channels:i.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:i.channels[0].pixelType,uncompress:null,getter:null,format:null,[Nt?"colorSpace":"encoding"]:null};switch(i.compression){case"NO_COMPRESSION":F.lines=1,F.uncompress=vt;break;case"RLE_COMPRESSION":F.lines=1,F.uncompress=ct;break;case"ZIPS_COMPRESSION":F.lines=1,F.uncompress=Lt;break;case"ZIP_COMPRESSION":F.lines=16,F.uncompress=Lt;break;case"PIZ_COMPRESSION":F.lines=32,F.uncompress=Rn;break;case"PXR24_COMPRESSION":F.lines=16,F.uncompress=on;break;case"DWAA_COMPRESSION":F.lines=32,F.uncompress=Et;break;case"DWAB_COMPRESSION":F.lines=256,F.uncompress=Et;break;default:throw"EXRLoader.parse: "+i.compression+" is unsupported"}if(F.scanlineBlockSize=F.lines,F.type==1)switch(I){case Ye:F.getter=je,F.inputSize=2;break;case we:F.getter=be,F.inputSize=2;break}else if(F.type==2)switch(I){case Ye:F.getter=Q,F.inputSize=4;break;case we:F.getter=ae,F.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+F.type+" for "+i.compression+".";F.blockCount=(i.dataWindow.yMax+1)/F.scanlineBlockSize;for(var L=0;L<F.blockCount;L++)_(A,E);F.outputChannels=F.channels==3?4:F.channels;const S=F.width*F.height*F.outputChannels;switch(I){case Ye:F.byteArray=new Float32Array(S),F.channels<F.outputChannels&&F.byteArray.fill(1,0,S);break;case we:F.byteArray=new Uint16Array(S),F.channels<F.outputChannels&&F.byteArray.fill(15360,0,S);break;default:console.error("THREE.EXRLoader: unsupported type: ",I);break}return F.bytesPerLine=F.width*F.inputSize*F.channels,F.outputChannels==4?F.format=Yt:F.format=Ls,Nt?F.colorSpace="srgb-linear":F.encoding=3e3,F}const un=new DataView(e),rs=new Uint8Array(e),Ot={value:0},Ut=ts(un,e,Ot),re=ns(Ut,un,rs,Ot,this.type),ir={value:0},ss={R:0,G:1,B:2,A:3,Y:0};for(let i=0;i<re.height/re.scanlineBlockSize;i++){const A=Te(un,Ot);re.size=Te(un,Ot),re.lines=A+re.scanlineBlockSize>re.height?re.height-A:re.scanlineBlockSize;const E=re.size<re.lines*re.bytesPerLine?re.uncompress(re):vt(re);Ot.value+=re.size;for(let I=0;I<re.scanlineBlockSize;I++){const F=I+i*re.scanlineBlockSize;if(F>=re.height)break;for(let L=0;L<re.channels;L++){const S=ss[Ut.channels[L].name];for(let N=0;N<re.width;N++){ir.value=(I*(re.channels*re.width)+L*re.width+N)*re.inputSize;const J=(re.height-1-F)*(re.width*re.outputChannels)+N*re.outputChannels+S;re.byteArray[J]=re.getter(E,ir)}}}}return{header:Ut,width:re.width,height:re.height,data:re.byteArray,format:re.format,[Nt?"colorSpace":"encoding"]:re[Nt?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,n,t,r){function s(a,c){Nt?a.colorSpace=c.colorSpace:a.encoding=c.encoding,a.minFilter=Ge,a.magFilter=Ge,a.generateMipmaps=!1,a.flipY=!1,n&&n(a,c)}return super.load(e,s,t,r)}}const Ln=new WeakMap;class fi extends Zn{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,n,t,r){const s=new it(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,a=>{const c={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(a,c).then(n).catch(r)},t,r)}decodeDracoFile(e,n,t,r){const s={attributeIDs:t||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!t};this.decodeGeometry(e,s).then(n)}decodeGeometry(e,n){for(const o in n.attributeTypes){const u=n.attributeTypes[o];u.BYTES_PER_ELEMENT!==void 0&&(n.attributeTypes[o]=u.name)}const t=JSON.stringify(n);if(Ln.has(e)){const o=Ln.get(e);if(o.key===t)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,a=e.byteLength,c=this._getWorker(s,a).then(o=>(r=o,new Promise((u,d)=>{r._callbacks[s]={resolve:u,reject:d},r.postMessage({type:"decode",id:s,taskConfig:n,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return c.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),Ln.set(e,{key:t,promise:c}),c}_createGeometry(e){const n=new yr;e.index&&n.setIndex(new jt(e.index.array,1));for(let t=0;t<e.attributes.length;t++){const r=e.attributes[t],s=r.name,a=r.array,c=r.itemSize;n.setAttribute(s,new jt(a,c))}return n}_loadLibrary(e,n){const t=new it(this.manager);return t.setPath(this.decoderPath),t.setResponseType(n),t.setWithCredentials(this.withCredentials),new Promise((r,s)=>{t.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",n=[];return e?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then(t=>{const r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const s=pi.toString(),a=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(e,n){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const a=s.data;switch(a.type){case"decode":r._callbacks[a.id].resolve(a);break;case"error":r._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const t=this.workerPool[this.workerPool.length-1];return t._taskCosts[e]=n,t._taskLoad+=n,t})}_releaseTask(e,n){e._taskLoad-=e._taskCosts[n],delete e._callbacks[n],delete e._taskCosts[n]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function pi(){let l,e;onmessage=function(a){const c=a.data;switch(c.type){case"init":l=c.decoderConfig,e=new Promise(function(d){l.onModuleLoaded=function(h){d({draco:h})},DracoDecoderModule(l)});break;case"decode":const o=c.buffer,u=c.taskConfig;e.then(d=>{const h=d.draco,f=new h.Decoder,B=new h.DecoderBuffer;B.Init(new Int8Array(o),o.byteLength);try{const C=n(h,f,B,u),v=C.attributes.map(g=>g.array.buffer);C.index&&v.push(C.index.array.buffer),self.postMessage({type:"decode",id:c.id,geometry:C},v)}catch(C){console.error(C),self.postMessage({type:"error",id:c.id,error:C.message})}finally{h.destroy(B),h.destroy(f)}});break}};function n(a,c,o,u){const d=u.attributeIDs,h=u.attributeTypes;let f,B;const C=c.GetEncodedGeometryType(o);if(C===a.TRIANGULAR_MESH)f=new a.Mesh,B=c.DecodeBufferToMesh(o,f);else if(C===a.POINT_CLOUD)f=new a.PointCloud,B=c.DecodeBufferToPointCloud(o,f);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!B.ok()||f.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+B.error_msg());const v={index:null,attributes:[]};for(const g in d){const T=self[h[g]];let R,H;if(u.useUniqueIDs)H=d[g],R=c.GetAttributeByUniqueId(f,H);else{if(H=c.GetAttributeId(f,a[d[g]]),H===-1)continue;R=c.GetAttribute(f,H)}v.attributes.push(r(a,c,f,g,T,R))}return C===a.TRIANGULAR_MESH&&(v.index=t(a,c,f)),a.destroy(f),v}function t(a,c,o){const d=o.num_faces()*3,h=d*4,f=a._malloc(h);c.GetTrianglesUInt32Array(o,h,f);const B=new Uint32Array(a.HEAPF32.buffer,f,d).slice();return a._free(f),{array:B,itemSize:1}}function r(a,c,o,u,d,h){const f=h.num_components(),C=o.num_points()*f,v=C*d.BYTES_PER_ELEMENT,g=s(a,d),T=a._malloc(v);c.GetAttributeDataArrayForAllPoints(o,h,g,v,T);const R=new d(a.HEAPF32.buffer,T,C).slice();return a._free(T),{name:u,array:R,itemSize:f}}function s(a,c){switch(c){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}let dn;const On=()=>{if(dn)return dn;const l="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",e="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",n=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let r=l;WebAssembly.validate(n)&&(r=e);let s;const a=WebAssembly.instantiate(c(r),{}).then(h=>{s=h.instance,s.exports.__wasm_call_ctors()});function c(h){const f=new Uint8Array(h.length);for(let C=0;C<h.length;++C){const v=h.charCodeAt(C);f[C]=v>96?v-71:v>64?v-65:v>47?v+4:v>46?63:62}let B=0;for(let C=0;C<h.length;++C)f[B++]=f[C]<60?t[f[C]]:(f[C]-60)*64+f[++C];return f.buffer.slice(0,B)}function o(h,f,B,C,v,g){const T=s.exports.sbrk,R=B+3&-4,H=T(R*C),w=T(v.length),b=new Uint8Array(s.exports.memory.buffer);b.set(v,w);const M=h(H,B,C,w,v.length);if(M===0&&g&&g(H,R,C),f.set(b.subarray(H,H+B*C)),T(H-T(0)),M!==0)throw new Error(`Malformed buffer data: ${M}`)}const u={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},d={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return dn={ready:a,supported:!0,decodeVertexBuffer(h,f,B,C,v){o(s.exports.meshopt_decodeVertexBuffer,h,f,B,C,s.exports[u[v]])},decodeIndexBuffer(h,f,B,C){o(s.exports.meshopt_decodeIndexBuffer,h,f,B,C)},decodeIndexSequence(h,f,B,C){o(s.exports.meshopt_decodeIndexSequence,h,f,B,C)},decodeGltfBuffer(h,f,B,C,v,g){o(s.exports[d[v]],h,f,B,C,s.exports[u[g]])}},dn};function Kr(l,e,n,t){const r=class extends St{constructor(a={}){const c=Object.entries(l);super({uniforms:c.reduce((o,[u,d])=>{const h=Os.clone({[u]:{value:d}});return{...o,...h}},{}),vertexShader:e,fragmentShader:n}),this.key="",c.forEach(([o])=>Object.defineProperty(this,o,{get:()=>this.uniforms[o].value,set:u=>this.uniforms[o].value=u})),Object.assign(this,a)}};return r.key=Xt.generateUUID(),r}const mi=()=>parseInt(Ir.replace(/\D+/g,"")),Qr=mi();let fn=null,jr="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Xr(l=!0,e=!0,n){return t=>{n&&n(t),l&&(fn||(fn=new fi),fn.setDecoderPath(typeof l=="string"?l:jr),t.setDRACOLoader(fn)),e&&t.setMeshoptDecoder(typeof On=="function"?On():On)}}const qt=(l,e,n,t)=>gt(Vn,l,Xr(e,n,t));qt.preload=(l,e,n,t)=>gt.preload(Vn,l,Xr(e,n,t));qt.clear=l=>gt.clear(Vn,l);qt.setDecoderPath=l=>{jr=l};function Bi(l,e,n){const t=de(f=>f.size),r=de(f=>f.viewport),s=typeof l=="number"?l:t.width*r.dpr,a=t.height*r.dpr,c=(typeof l=="number"?n:l)||{},{samples:o=0,depth:u,...d}=c,h=D.useMemo(()=>{const f=new Ct(s,a,{minFilter:Ge,magFilter:Ge,type:we,...d});return u&&(f.depthTexture=new Us(s,a,Ye)),f.samples=o,f},[]);return D.useLayoutEffect(()=>{h.setSize(s,a),o&&(h.samples=o)},[o,h,s,a]),D.useEffect(()=>()=>h.dispose(),[]),h}const gi=l=>typeof l=="function",Ci=D.forwardRef(({envMap:l,resolution:e=256,frames:n=1/0,makeDefault:t,children:r,...s},a)=>{const c=de(({set:g})=>g),o=de(({camera:g})=>g),u=de(({size:g})=>g),d=D.useRef(null);D.useImperativeHandle(a,()=>d.current,[]);const h=D.useRef(null),f=Bi(e);D.useLayoutEffect(()=>{s.manual||(d.current.aspect=u.width/u.height)},[u,s]),D.useLayoutEffect(()=>{d.current.updateProjectionMatrix()});let B=0,C=null;const v=gi(r);return xt(g=>{v&&(n===1/0||B<n)&&(h.current.visible=!1,g.gl.setRenderTarget(f),C=g.scene.background,l&&(g.scene.background=l),g.gl.render(g.scene,d.current),g.scene.background=C,g.gl.setRenderTarget(null),h.current.visible=!0,B++)}),D.useLayoutEffect(()=>{if(t){const g=o;return c(()=>({camera:d.current})),()=>c(()=>({camera:g}))}},[d,t,c]),D.createElement(D.Fragment,null,D.createElement("perspectiveCamera",Ze({ref:d},s),!v&&r),D.createElement("group",{ref:h},v&&r(f.texture)))}),vi=D.forwardRef(({makeDefault:l,camera:e,regress:n,domElement:t,enableDamping:r=!0,keyEvents:s=!1,onChange:a,onStart:c,onEnd:o,...u},d)=>{const h=de(M=>M.invalidate),f=de(M=>M.camera),B=de(M=>M.gl),C=de(M=>M.events),v=de(M=>M.setEvents),g=de(M=>M.set),T=de(M=>M.get),R=de(M=>M.performance),H=e||f,w=t||C.connected||B.domElement,b=D.useMemo(()=>new ba(H),[H]);return xt(()=>{b.enabled&&b.update()},-1),D.useEffect(()=>(s&&b.connect(s===!0?w:s),b.connect(w),()=>void b.dispose()),[s,w,n,b,h]),D.useEffect(()=>{const M=G=>{h(),n&&R.regress(),a&&a(G)},x=G=>{c&&c(G)},y=G=>{o&&o(G)};return b.addEventListener("change",M),b.addEventListener("start",x),b.addEventListener("end",y),()=>{b.removeEventListener("start",x),b.removeEventListener("end",y),b.removeEventListener("change",M)}},[a,c,o,b,h,v]),D.useEffect(()=>{if(l){const M=T().controls;return g({controls:b}),()=>g({controls:M})}},[l,b]),D.createElement("primitive",Ze({ref:d,object:b,enableDamping:r},u))}),Ei=D.forwardRef(function({children:e,disable:n,disableX:t,disableY:r,disableZ:s,left:a,right:c,top:o,bottom:u,front:d,back:h,onCentered:f,precise:B=!0,cacheKey:C=0,...v},g){const T=D.useRef(null),R=D.useRef(null),H=D.useRef(null);return D.useLayoutEffect(()=>{R.current.matrixWorld.identity();const w=new Yn().setFromObject(H.current,B),b=new $,M=new wr,x=w.max.x-w.min.x,y=w.max.y-w.min.y,G=w.max.z-w.min.z;w.getCenter(b),w.getBoundingSphere(M);const U=o?y/2:u?-y/2:0,W=a?-x/2:c?x/2:0,V=d?G/2:h?-G/2:0;R.current.position.set(n||t?0:-b.x+W,n||r?0:-b.y+U,n||s?0:-b.z+V),typeof f<"u"&&f({parent:T.current.parent,container:T.current,width:x,height:y,depth:G,boundingBox:w,boundingSphere:M,center:b,verticalAlignment:U,horizontalAlignment:W,depthAlignment:V})},[C,f,o,a,d,n,t,r,s,B,c,u,h]),D.useImperativeHandle(g,()=>T.current,[]),D.createElement("group",Ze({ref:T},v),D.createElement("group",{ref:R},D.createElement("group",{ref:H},e)))}),Mi=3e3,Ii=3001,Fi=Kr({},"void main() { }","void main() { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); discard;  }");var Oe=function(l){return l[l.NONE=0]="NONE",l[l.START=1]="START",l[l.ACTIVE=2]="ACTIVE",l}(Oe||{});const Dt=l=>l&&l.isOrthographicCamera,Ri=l=>l&&l.isBox3,Ti=l=>1-Math.exp(-5*l)+.007*l,Zr=D.createContext(null);function Di({children:l,maxDuration:e=1,margin:n=1.2,observe:t,fit:r,clip:s,interpolateFunc:a=Ti,onFit:c}){const o=D.useRef(null),{camera:u,size:d,invalidate:h}=de(),f=de(b=>b.controls),B=D.useRef(c);B.current=c;const C=D.useRef({camPos:new $,camRot:new mt,camZoom:1}),v=D.useRef({camPos:void 0,camRot:void 0,camZoom:void 0,camUp:void 0,target:void 0}),g=D.useRef(Oe.NONE),T=D.useRef(0),[R]=D.useState(()=>new Yn),H=D.useMemo(()=>{function b(){const M=R.getSize(new $),x=R.getCenter(new $),y=Math.max(M.x,M.y,M.z),G=Dt(u)?y*4:y/(2*Math.atan(Math.PI*u.fov/360)),U=Dt(u)?y*4:G/u.aspect,W=n*Math.max(G,U);return{box:R,size:M,center:x,distance:W}}return{getSize:b,refresh(M){if(Ri(M))R.copy(M);else{const x=M||o.current;if(!x)return this;x.updateWorldMatrix(!0,!0),R.setFromObject(x)}if(R.isEmpty()){const x=u.position.length()||10;R.setFromCenterAndSize(new $,new $(x,x,x))}return C.current.camPos.copy(u.position),C.current.camRot.copy(u.quaternion),Dt(u)&&(C.current.camZoom=u.zoom),v.current.camPos=void 0,v.current.camRot=void 0,v.current.camZoom=void 0,v.current.camUp=void 0,v.current.target=void 0,this},reset(){const{center:M,distance:x}=b(),y=u.position.clone().sub(M).normalize();v.current.camPos=M.clone().addScaledVector(y,x),v.current.target=M.clone();const G=new Bt().lookAt(v.current.camPos,v.current.target,u.up);return v.current.camRot=new mt().setFromRotationMatrix(G),g.current=Oe.START,T.current=0,this},moveTo(M){return v.current.camPos=Array.isArray(M)?new $(...M):M.clone(),g.current=Oe.START,T.current=0,this},lookAt({target:M,up:x}){v.current.target=Array.isArray(M)?new $(...M):M.clone(),x?v.current.camUp=Array.isArray(x)?new $(...x):x.clone():v.current.camUp=u.up.clone();const y=new Bt().lookAt(v.current.camPos||u.position,v.current.target,v.current.camUp);return v.current.camRot=new mt().setFromRotationMatrix(y),g.current=Oe.START,T.current=0,this},to({position:M,target:x}){return this.moveTo(M).lookAt({target:x})},fit(){if(!Dt(u))return this.reset();let M=0,x=0;const y=[new $(R.min.x,R.min.y,R.min.z),new $(R.min.x,R.max.y,R.min.z),new $(R.min.x,R.min.y,R.max.z),new $(R.min.x,R.max.y,R.max.z),new $(R.max.x,R.max.y,R.max.z),new $(R.max.x,R.max.y,R.min.z),new $(R.max.x,R.min.y,R.max.z),new $(R.max.x,R.min.y,R.min.z)],G=v.current.camPos||u.position,U=v.current.target||(f==null?void 0:f.target),W=v.current.camUp||u.up,V=U?new Bt().lookAt(G,U,W).setPosition(G).invert():u.matrixWorldInverse;for(const ne of y)ne.applyMatrix4(V),M=Math.max(M,Math.abs(ne.y)),x=Math.max(x,Math.abs(ne.x));M*=2,x*=2;const Y=(u.top-u.bottom)/M,K=(u.right-u.left)/x;return v.current.camZoom=Math.min(Y,K)/n,g.current=Oe.START,T.current=0,B.current&&B.current(this.getSize()),this},clip(){const{distance:M}=b();return u.near=M/100,u.far=M*100,u.updateProjectionMatrix(),f&&(f.maxDistance=M*10,f.update()),h(),this}}},[R,u,f,n,h]);D.useLayoutEffect(()=>{if(f){const b=()=>{if(f&&v.current.target&&g.current!==Oe.NONE){const M=new $().setFromMatrixColumn(u.matrix,2),x=C.current.camPos.distanceTo(f.target),y=(v.current.camPos||C.current.camPos).distanceTo(v.current.target),G=(1-T.current)*x+T.current*y;f.target.copy(u.position).addScaledVector(M,-G),f.update()}g.current=Oe.NONE};return f.addEventListener("start",b),()=>f.removeEventListener("start",b)}},[f]);const w=D.useRef(0);return D.useLayoutEffect(()=>{(t||w.current++===0)&&(H.refresh(),r&&H.reset().fit(),s&&H.clip())},[d,s,r,t,u,f]),xt((b,M)=>{if(g.current===Oe.START)g.current=Oe.ACTIVE,h();else if(g.current===Oe.ACTIVE){if(T.current+=M/e,T.current>=1)v.current.camPos&&u.position.copy(v.current.camPos),v.current.camRot&&u.quaternion.copy(v.current.camRot),v.current.camUp&&u.up.copy(v.current.camUp),v.current.camZoom&&Dt(u)&&(u.zoom=v.current.camZoom),u.updateMatrixWorld(),u.updateProjectionMatrix(),f&&v.current.target&&(f.target.copy(v.current.target),f.update()),g.current=Oe.NONE;else{const x=a(T.current);v.current.camPos&&u.position.lerpVectors(C.current.camPos,v.current.camPos,x),v.current.camRot&&u.quaternion.slerpQuaternions(C.current.camRot,v.current.camRot,x),v.current.camUp&&u.up.set(0,1,0).applyQuaternion(u.quaternion),v.current.camZoom&&Dt(u)&&(u.zoom=(1-x)*C.current.camZoom+x*v.current.camZoom),u.updateMatrixWorld(),u.updateProjectionMatrix()}h()}}),D.createElement("group",{ref:o},D.createElement(Zr.Provider,{value:H},l))}function bi(){return D.useContext(Zr)}const Yr=(l,e,n)=>{let t;switch(l){case kn:t=new Uint8ClampedArray(e*n*4);break;case we:t=new Uint16Array(e*n*4);break;case Qs:t=new Uint32Array(e*n*4);break;case Ks:t=new Int8Array(e*n*4);break;case ks:t=new Int16Array(e*n*4);break;case Ns:t=new Int32Array(e*n*4);break;case Ye:t=new Float32Array(e*n*4);break;default:throw new Error("Unsupported data type")}return t};let pn;const yi=(l,e,n,t)=>{if(pn!==void 0)return pn;const r=new Ct(1,1,t);e.setRenderTarget(r);const s=new zt(new Wn,new bt({color:16777215}));e.render(s,n),e.setRenderTarget(null);const a=Yr(l,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,a),r.dispose(),s.geometry.dispose(),s.material.dispose(),pn=a[0]!==0,pn};class qn{constructor(e){var n,t,r,s,a,c,o,u,d,h,f,B,C,v,g,T;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(H){throw this._renderer.setRenderTarget(null),H}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const R={format:Yt,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=e.renderTargetOptions)===null||n===void 0?void 0:n.anisotropy)!==void 0?(t=e.renderTargetOptions)===null||t===void 0?void 0:t.anisotropy:1,generateMipmaps:((r=e.renderTargetOptions)===null||r===void 0?void 0:r.generateMipmaps)!==void 0?(s=e.renderTargetOptions)===null||s===void 0?void 0:s.generateMipmaps:!1,magFilter:((a=e.renderTargetOptions)===null||a===void 0?void 0:a.magFilter)!==void 0?(c=e.renderTargetOptions)===null||c===void 0?void 0:c.magFilter:Ge,minFilter:((o=e.renderTargetOptions)===null||o===void 0?void 0:o.minFilter)!==void 0?(u=e.renderTargetOptions)===null||u===void 0?void 0:u.minFilter:Ge,samples:((d=e.renderTargetOptions)===null||d===void 0?void 0:d.samples)!==void 0?(h=e.renderTargetOptions)===null||h===void 0?void 0:h.samples:void 0,wrapS:((f=e.renderTargetOptions)===null||f===void 0?void 0:f.wrapS)!==void 0?(B=e.renderTargetOptions)===null||B===void 0?void 0:B.wrapS:$e,wrapT:((C=e.renderTargetOptions)===null||C===void 0?void 0:C.wrapT)!==void 0?(v=e.renderTargetOptions)===null||v===void 0?void 0:v.wrapT:$e};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=qn.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new xr,this._camera=new Kt,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!yi(this._type,this._renderer,this._camera,R)){let H;switch(this._type){case we:H=this._renderer.extensions.has("EXT_color_buffer_float")?Ye:void 0;break}H!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Ye}`),this._type=H):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new zt(new Wn,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new Ct(this.width,this.height,R),this._renderTarget.texture.mapping=((g=e.renderTargetOptions)===null||g===void 0?void 0:g.mapping)!==void 0?(T=e.renderTargetOptions)===null||T===void 0?void 0:T.mapping:Bn}static instantiateRenderer(){const e=new Ps;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=Yr(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const n=new Js(this.toArray(),this.width,this.height,Yt,this._type,(e==null?void 0:e.mapping)||Bn,(e==null?void 0:e.wrapS)||$e,(e==null?void 0:e.wrapT)||$e,(e==null?void 0:e.magFilter)||Ge,(e==null?void 0:e.minFilter)||Ge,(e==null?void 0:e.anisotropy)||1,Nn);return n.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,n}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof St&&Object.values(this.material.uniforms).forEach(n=>{n.value instanceof st&&n.value.dispose()}),Object.values(this.material).forEach(n=>{n instanceof st&&n.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const Gi=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,wi=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class Si extends St{constructor({gamma:e,offsetHdr:n,offsetSdr:t,gainMapMin:r,gainMapMax:s,maxDisplayBoost:a,hdrCapacityMin:c,hdrCapacityMax:o,sdr:u,gainMap:d}){super({name:"GainMapDecoderMaterial",vertexShader:Gi,fragmentShader:wi,uniforms:{sdr:{value:u},gainMap:{value:d},gamma:{value:new $(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new $().fromArray(n)},offsetSdr:{value:new $().fromArray(t)},gainMapMin:{value:new $().fromArray(r)},gainMapMax:{value:new $().fromArray(s)},weightFactor:{value:(Math.log2(a)-c)/(o-c)}},blending:Zs,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=a,this._hdrCapacityMin=c,this._hdrCapacityMax=o,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const n=this.uniforms.gamma.value;n.x=1/e[0],n.y=1/e[1],n.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class Wr extends Error{}class zr extends Error{}const kt=(l,e,n)=>{const t=new RegExp(`${e}="([^"]*)"`,"i").exec(l);if(t)return t[1];const r=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(l);if(r){const s=r[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(a=>a.replace(/<\/?rdf:li>/g,"")):r[1].trim()}if(n!==void 0)return n;throw new Error(`Can't find ${e} in gainmap metadata`)},xi=l=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(l):e=l.toString();let n=e.indexOf("<x:xmpmeta");for(;n!==-1;){const t=e.indexOf("x:xmpmeta>",n),r=e.slice(n,t+10);try{const s=kt(r,"hdrgm:GainMapMin","0"),a=kt(r,"hdrgm:GainMapMax"),c=kt(r,"hdrgm:Gamma","1"),o=kt(r,"hdrgm:OffsetSDR","0.015625"),u=kt(r,"hdrgm:OffsetHDR","0.015625"),d=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),h=d?d[1]:"0",f=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!f)throw new Error("Incomplete gainmap metadata");const B=f[1];return{gainMapMin:Array.isArray(s)?s.map(C=>parseFloat(C)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(a)?a.map(C=>parseFloat(C)):[parseFloat(a),parseFloat(a),parseFloat(a)],gamma:Array.isArray(c)?c.map(C=>parseFloat(C)):[parseFloat(c),parseFloat(c),parseFloat(c)],offsetSdr:Array.isArray(o)?o.map(C=>parseFloat(C)):[parseFloat(o),parseFloat(o),parseFloat(o)],offsetHdr:Array.isArray(u)?u.map(C=>parseFloat(C)):[parseFloat(u),parseFloat(u),parseFloat(u)],hdrCapacityMin:parseFloat(h),hdrCapacityMax:parseFloat(B)}}catch{}n=e.indexOf("<x:xmpmeta",t)}};class _i{constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((n,t)=>{const r=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){t(new Error("Not a valid jpeg"));return}const a=s.byteLength;let c=2,o=0,u;for(;c<a;){if(++o>250){t(new Error(`Found no marker after ${o} loops 😵`));return}if(s.getUint8(c)!==255){t(new Error(`Not a valid marker at offset 0x${c.toString(16)}, found: 0x${s.getUint8(c).toString(16)}`));return}if(u=s.getUint8(c+1),r&&console.log(`Marker: ${u.toString(16)}`),u===226){r&&console.log("Found APP2 marker (0xffe2)");const d=c+4;if(s.getUint32(d)===1297106432){const h=d+4;let f;if(s.getUint16(h)===18761)f=!1;else if(s.getUint16(h)===19789)f=!0;else{t(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(h+2,!f)!==42){t(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const B=s.getUint32(h+4,!f);if(B<8){t(new Error("Not valid TIFF data! (First offset less than 8)"));return}const C=h+B,v=s.getUint16(C,!f),g=C+2;let T=0;for(let b=g;b<g+12*v;b+=12)s.getUint16(b,!f)===45057&&(T=s.getUint32(b+8,!f));const H=C+2+v*12+4,w=[];for(let b=H;b<H+T*16;b+=16){const M={MPType:s.getUint32(b,!f),size:s.getUint32(b+4,!f),dataOffset:s.getUint32(b+8,!f),dependantImages:s.getUint32(b+12,!f),start:-1,end:-1,isFII:!1};M.dataOffset?(M.start=h+M.dataOffset,M.isFII=!1):(M.start=0,M.isFII=!0),M.end=M.start+M.size,w.push(M)}if(this.options.extractNonFII&&w.length){const b=new Blob([s]),M=[];for(const x of w){if(x.isFII&&!this.options.extractFII)continue;const y=b.slice(x.start,x.end+1,"image/jpeg");M.push(y)}n(M)}}}c+=2+s.getUint16(c+2)}})}}const Hi=async l=>{const e=xi(l);if(!e)throw new zr("Gain map XMP metadata not found");const t=await new _i({extractFII:!0,extractNonFII:!0}).extract(l);if(t.length!==2)throw new Wr("Gain map recovery image not found");return{sdr:new Uint8Array(await t[0].arrayBuffer()),gainMap:new Uint8Array(await t[1].arrayBuffer()),metadata:e}},Er=l=>new Promise((e,n)=>{const t=document.createElement("img");t.onload=()=>{e(t)},t.onerror=r=>{n(r)},t.src=URL.createObjectURL(l)});class Vr extends Zn{constructor(e,n){super(n),e&&(this._renderer=e),this._internalLoadingManager=new js}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new Si({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new st,sdr:new st});return new qn({width:16,height:16,type:we,colorSpace:Nn,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,n,t,r){const s=r?new Blob([r],{type:"image/jpeg"}):void 0,a=new Blob([t],{type:"image/jpeg"});let c,o,u=!1;if(typeof createImageBitmap>"u"){const f=await Promise.all([s?Er(s):Promise.resolve(void 0),Er(a)]);o=f[0],c=f[1],u=!0}else{const f=await Promise.all([s?createImageBitmap(s,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(a,{imageOrientation:"flipY"})]);o=f[0],c=f[1]}const d=new st(o||new ImageData(2,2),Bn,$e,$e,Ge,Ar,Yt,kn,1,Nn);d.flipY=u,d.needsUpdate=!0;const h=new st(c,Bn,$e,$e,Ge,Ar,Yt,kn,1,Xs);h.flipY=u,h.needsUpdate=!0,e.width=c.width,e.height=c.height,e.material.gainMap=d,e.material.sdr=h,e.material.gainMapMin=n.gainMapMin,e.material.gainMapMax=n.gainMapMax,e.material.offsetHdr=n.offsetHdr,e.material.offsetSdr=n.offsetSdr,e.material.gamma=n.gamma,e.material.hdrCapacityMin=n.hdrCapacityMin,e.material.hdrCapacityMax=n.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,n.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class Li extends Vr{load([e,n,t],r,s,a){const c=this.prepareQuadRenderer();let o,u,d;const h=async()=>{if(o&&u&&d){try{await this.render(c,d,o,u)}catch(G){this.manager.itemError(e),this.manager.itemError(n),this.manager.itemError(t),typeof a=="function"&&a(G),c.disposeOnDemandRenderer();return}typeof r=="function"&&r(c),this.manager.itemEnd(e),this.manager.itemEnd(n),this.manager.itemEnd(t),c.disposeOnDemandRenderer()}};let f=!0,B=0,C=0,v=!0,g=0,T=0,R=!0,H=0,w=0;const b=()=>{if(typeof s=="function"){const G=B+g+H,U=C+T+w,W=f&&v&&R;s(new ProgressEvent("progress",{lengthComputable:W,loaded:U,total:G}))}};this.manager.itemStart(e),this.manager.itemStart(n),this.manager.itemStart(t);const M=new it(this._internalLoadingManager);M.setResponseType("arraybuffer"),M.setRequestHeader(this.requestHeader),M.setPath(this.path),M.setWithCredentials(this.withCredentials),M.load(e,async G=>{if(typeof G=="string")throw new Error("Invalid sdr buffer");o=G,await h()},G=>{f=G.lengthComputable,C=G.loaded,B=G.total,b()},G=>{this.manager.itemError(e),typeof a=="function"&&a(G)});const x=new it(this._internalLoadingManager);x.setResponseType("arraybuffer"),x.setRequestHeader(this.requestHeader),x.setPath(this.path),x.setWithCredentials(this.withCredentials),x.load(n,async G=>{if(typeof G=="string")throw new Error("Invalid gainmap buffer");u=G,await h()},G=>{v=G.lengthComputable,T=G.loaded,g=G.total,b()},G=>{this.manager.itemError(n),typeof a=="function"&&a(G)});const y=new it(this._internalLoadingManager);return y.setRequestHeader(this.requestHeader),y.setPath(this.path),y.setWithCredentials(this.withCredentials),y.load(t,async G=>{if(typeof G!="string")throw new Error("Invalid metadata string");d=JSON.parse(G),await h()},G=>{R=G.lengthComputable,w=G.loaded,H=G.total,b()},G=>{this.manager.itemError(t),typeof a=="function"&&a(G)}),c}}class Oi extends Vr{load(e,n,t,r){const s=this.prepareQuadRenderer(),a=new it(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,async c=>{if(typeof c=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const o=new Uint8Array(c);let u,d,h;try{const f=await Hi(o);u=f.sdr,d=f.gainMap,h=f.metadata}catch(f){if(f instanceof zr||f instanceof Wr)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),h={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},u=o;else throw f}try{await this.render(s,h,u,d)}catch(f){this.manager.itemError(e),typeof r=="function"&&r(f),s.disposeOnDemandRenderer();return}typeof n=="function"&&n(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},t,c=>{this.manager.itemError(e),typeof r=="function"&&r(c)}),s}}const Wt={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},qr="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",wt=l=>Array.isArray(l),$n=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function Cn({files:l=$n,path:e="",preset:n=void 0,encoding:t=void 0,extensions:r}={}){let s=null,a=!1;n&&(er(n),l=Wt[n],e=qr),a=wt(l);const{extension:c,isCubemap:o}=tr(l);if(s=nr(c),!s)throw new Error("useEnvironment: Unrecognized file extension: "+l);const u=de(B=>B.gl);D.useLayoutEffect(()=>{if(c!=="webp"&&c!=="jpg"&&c!=="jpeg")return;function B(){gt.clear(s,a?[l]:l)}u.domElement.addEventListener("webglcontextlost",B,{once:!0})},[l,u.domElement]);const d=gt(s,a?[l]:l,B=>{(c==="webp"||c==="jpg"||c==="jpeg")&&B.setRenderer(u),B.setPath==null||B.setPath(e),r&&r(B)});let h=a?d[0]:d;if(c==="jpg"||c==="jpeg"||c==="webp"){var f;h=(f=h.renderTarget)==null?void 0:f.texture}return h.mapping=o?Ys:Ws,"colorSpace"in h?h.colorSpace=t??o?"srgb":"srgb-linear":h.encoding=t??o?Ii:Mi,h}const Ui={files:$n,path:"",preset:void 0,extensions:void 0};Cn.preload=l=>{const e={...Ui,...l};let{files:n,path:t=""}=e;const{preset:r,extensions:s}=e;r&&(er(r),n=Wt[r],t=qr);const{extension:a}=tr(n);if(a==="webp"||a==="jpg"||a==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const c=nr(a);if(!c)throw new Error("useEnvironment: Unrecognized file extension: "+n);gt.preload(c,wt(n)?[n]:n,o=>{o.setPath==null||o.setPath(t),s&&s(o)})};const Pi={files:$n,preset:void 0};Cn.clear=l=>{const e={...Pi,...l};let{files:n}=e;const{preset:t}=e;t&&(er(t),n=Wt[t]);const{extension:r}=tr(n),s=nr(r);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+n);gt.clear(s,wt(n)?[n]:n)};function er(l){if(!(l in Wt))throw new Error("Preset must be one of: "+Object.keys(Wt).join(", "))}function tr(l){var e;const n=wt(l)&&l.length===6,t=wt(l)&&l.length===3&&l.some(a=>a.endsWith("json")),r=wt(l)?l[0]:l;return{extension:n?"cube":t?"webp":r.startsWith("data:application/exr")?"exr":r.startsWith("data:application/hdr")?"hdr":r.startsWith("data:image/jpeg")?"jpg":(e=r.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:n,isGainmap:t}}function nr(l){return l==="cube"?zs:l==="hdr"?hi:l==="exr"?di:l==="jpg"||l==="jpeg"?Oi:l==="webp"?Li:null}const Ji=l=>l.current&&l.current.isScene,Ni=l=>Ji(l)?l.current:l;function rr(l,e,n,t,r={}){var s,a,c,o;r={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...r};const u=Ni(e||n),d=u.background,h=u.environment,f={backgroundBlurriness:u.backgroundBlurriness,backgroundIntensity:u.backgroundIntensity,backgroundRotation:(s=(a=u.backgroundRotation)==null||a.clone==null?void 0:a.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:u.environmentIntensity,environmentRotation:(c=(o=u.environmentRotation)==null||o.clone==null?void 0:o.clone())!==null&&c!==void 0?c:[0,0,0]};return l!=="only"&&(u.environment=t),l&&(u.background=t),hr(u,r),()=>{l!=="only"&&(u.environment=h),l&&(u.background=d),hr(u,f)}}function sr({scene:l,background:e=!1,map:n,...t}){const r=de(s=>s.scene);return D.useLayoutEffect(()=>{if(n)return rr(e,l,r,n,t)}),null}function $r({background:l=!1,scene:e,blur:n,backgroundBlurriness:t,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:a,environmentRotation:c,...o}){const u=Cn(o),d=de(h=>h.scene);return D.useLayoutEffect(()=>rr(l,e,d,u,{backgroundBlurriness:n??t,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:a,environmentRotation:c})),D.useEffect(()=>()=>{u.dispose()},[u]),null}function ki({children:l,near:e=.1,far:n=1e3,resolution:t=256,frames:r=1,map:s,background:a=!1,blur:c,backgroundBlurriness:o,backgroundIntensity:u,backgroundRotation:d,environmentIntensity:h,environmentRotation:f,scene:B,files:C,path:v,preset:g=void 0,extensions:T}){const R=de(y=>y.gl),H=de(y=>y.scene),w=D.useRef(null),[b]=D.useState(()=>new xr),M=D.useMemo(()=>{const y=new Vs(t);return y.texture.type=we,y},[t]);D.useEffect(()=>()=>{M.dispose()},[M]),D.useLayoutEffect(()=>{if(r===1){const y=R.autoClear;R.autoClear=!0,w.current.update(R,b),R.autoClear=y}return rr(a,B,H,M.texture,{backgroundBlurriness:c??o,backgroundIntensity:u,backgroundRotation:d,environmentIntensity:h,environmentRotation:f})},[l,b,M.texture,B,H,a,r,R]);let x=1;return xt(()=>{if(r===1/0||x<r){const y=R.autoClear;R.autoClear=!0,w.current.update(R,b),R.autoClear=y,x++}}),D.createElement(D.Fragment,null,qs(D.createElement(D.Fragment,null,l,D.createElement("cubeCamera",{ref:w,args:[e,n,M]}),C||g?D.createElement($r,{background:!0,files:C,preset:g,path:v,extensions:T}):s?D.createElement(sr,{background:!0,map:s,extensions:T}):null),b))}function Ki(l){var e,n,t,r;const s=Cn(l),a=l.map||s;D.useMemo(()=>_r({GroundProjectedEnvImpl:va}),[]),D.useEffect(()=>()=>{s.dispose()},[s]);const c=D.useMemo(()=>[a],[a]),o=(e=l.ground)==null?void 0:e.height,u=(n=l.ground)==null?void 0:n.radius,d=(t=(r=l.ground)==null?void 0:r.scale)!==null&&t!==void 0?t:1e3;return D.createElement(D.Fragment,null,D.createElement(sr,Ze({},l,{map:a})),D.createElement("groundProjectedEnvImpl",{args:c,scale:d,height:o,radius:u}))}function Qi(l){return l.ground?D.createElement(Ki,l):l.map?D.createElement(sr,l):l.children?D.createElement(ki,l):D.createElement($r,l)}const ji=D.forwardRef(({scale:l=10,frames:e=1/0,opacity:n=1,width:t=1,height:r=1,blur:s=1,near:a=0,far:c=10,resolution:o=512,smooth:u=!0,color:d="#000000",depthWrite:h=!1,renderOrder:f,...B},C)=>{const v=D.useRef(null),g=de(K=>K.scene),T=de(K=>K.gl),R=D.useRef(null);t=t*(Array.isArray(l)?l[0]:l||1),r=r*(Array.isArray(l)?l[1]:l||1);const[H,w,b,M,x,y,G]=D.useMemo(()=>{const K=new Ct(o,o),ne=new Ct(o,o);ne.texture.generateMipmaps=K.texture.generateMipmaps=!1;const z=new Wn(t,r).rotateX(Math.PI/2),Ie=new zt(z),ve=new $s;ve.depthTest=ve.depthWrite=!1,ve.onBeforeCompile=Ee=>{Ee.uniforms={...Ee.uniforms,ucolor:{value:new We(d)}},Ee.fragmentShader=Ee.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),Ee.fragmentShader=Ee.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const Fe=new St(ui),se=new St(Ai);return se.depthTest=Fe.depthTest=!1,[K,z,ve,Ie,Fe,se,ne]},[o,t,r,l,d]),U=K=>{M.visible=!0,M.material=x,x.uniforms.tDiffuse.value=H.texture,x.uniforms.h.value=K*1/256,T.setRenderTarget(G),T.render(M,R.current),M.material=y,y.uniforms.tDiffuse.value=G.texture,y.uniforms.v.value=K*1/256,T.setRenderTarget(H),T.render(M,R.current),M.visible=!1};let W=0,V,Y;return xt(()=>{R.current&&(e===1/0||W<e)&&(W++,V=g.background,Y=g.overrideMaterial,v.current.visible=!1,g.background=null,g.overrideMaterial=b,T.setRenderTarget(H),T.render(g,R.current),U(s),u&&U(s*.4),T.setRenderTarget(null),v.current.visible=!0,g.overrideMaterial=Y,g.background=V)}),D.useImperativeHandle(C,()=>v.current,[]),D.createElement("group",Ze({"rotation-x":Math.PI/2},B,{ref:v}),D.createElement("mesh",{renderOrder:f,geometry:w,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},D.createElement("meshBasicMaterial",{transparent:!0,map:H.texture,opacity:n,depthWrite:h})),D.createElement("orthographicCamera",{ref:R,args:[-t/2,t/2,r/2,-r/2,a,c]}))});function Xi(l){return l.isLight}function Zi(l){return!!l.geometry}const es=D.createContext(null),Yi=Kr({color:new We,blend:2,alphaTest:.75,opacity:0,map:null},`varying vec2 vUv;
   void main() {
     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
     vUv = uv;
   }`,`varying vec2 vUv;
   uniform sampler2D map;
   uniform vec3 color;
   uniform float opacity;
   uniform float alphaTest;
   uniform float blend;
   void main() {
     vec4 sampledDiffuseColor = texture2D(map, vUv);
     gl_FragColor = vec4(color * sampledDiffuseColor.r * blend, max(0.0, (1.0 - (sampledDiffuseColor.r + sampledDiffuseColor.g + sampledDiffuseColor.b) / alphaTest)) * opacity);
     #include <tonemapping_fragment>
     #include <${Qr>=154?"colorspace_fragment":"encodings_fragment"}>
   }`),Wi=D.forwardRef(({children:l,temporal:e,frames:n=40,limit:t=1/0,blend:r=20,scale:s=10,opacity:a=1,alphaTest:c=.75,color:o="black",colorBlend:u=2,resolution:d=1024,toneMapped:h=!0,...f},B)=>{_r({SoftShadowMaterial:Yi});const C=de(M=>M.gl),v=de(M=>M.scene),g=de(M=>M.camera),T=de(M=>M.invalidate),R=D.useRef(null),H=D.useRef(null),[w]=D.useState(()=>new Vi(C,v,d));D.useLayoutEffect(()=>{w.configure(R.current)},[]);const b=D.useMemo(()=>({lights:new Map,temporal:!!e,frames:Math.max(2,n),blend:Math.max(2,n===1/0?r:n),count:0,getMesh:()=>R.current,reset:()=>{w.clear();const M=R.current.material;M.opacity=0,M.alphaTest=0,b.count=0},update:(M=1)=>{const x=R.current.material;b.temporal?(x.opacity=Math.min(a,x.opacity+a/b.blend),x.alphaTest=Math.min(c,x.alphaTest+c/b.blend)):(x.opacity=a,x.alphaTest=c),H.current.visible=!0,w.prepare();for(let y=0;y<M;y++)b.lights.forEach(G=>G.update()),w.update(g,b.blend);H.current.visible=!1,w.finish()}}),[w,g,v,e,n,r,a,c]);return D.useLayoutEffect(()=>{b.reset(),!b.temporal&&b.frames!==1/0&&b.update(b.blend)}),D.useImperativeHandle(B,()=>b,[b]),xt(()=>{(b.temporal||b.frames===1/0)&&b.count<b.frames&&b.count<t&&(T(),b.update(),b.count++)}),D.createElement("group",f,D.createElement("group",{traverse:()=>null,ref:H},D.createElement(es.Provider,{value:b},l)),D.createElement("mesh",{receiveShadow:!0,ref:R,scale:s,rotation:[-Math.PI/2,0,0]},D.createElement("planeGeometry",null),D.createElement("softShadowMaterial",{transparent:!0,depthWrite:!1,toneMapped:h,color:o,blend:u,map:w.progressiveLightMap2.texture})))}),zi=D.forwardRef(({castShadow:l=!0,bias:e=.001,mapSize:n=512,size:t=5,near:r=.5,far:s=500,frames:a=1,position:c=[0,0,0],radius:o=1,amount:u=8,intensity:d=Qr>=155?Math.PI:1,ambient:h=.5,...f},B)=>{const C=D.useRef(null),v=new $(...c).length(),g=D.useContext(es),T=D.useCallback(()=>{let H;if(C.current)for(let w=0;w<C.current.children.length;w++)if(H=C.current.children[w],Math.random()>h)H.position.set(c[0]+Xt.randFloatSpread(o),c[1]+Xt.randFloatSpread(o),c[2]+Xt.randFloatSpread(o));else{let b=Math.acos(2*Math.random()-1)-Math.PI/2,M=2*Math.PI*Math.random();H.position.set(Math.cos(b)*Math.cos(M)*v,Math.abs(Math.cos(b)*Math.sin(M)*v),Math.sin(b)*v)}},[o,h,v,...c]),R=D.useMemo(()=>({update:T}),[T]);return D.useImperativeHandle(B,()=>R,[R]),D.useLayoutEffect(()=>{var H;const w=C.current;return g&&((H=g.lights)==null||H.set(w.uuid,R)),()=>{var b;return void(g==null||(b=g.lights)==null?void 0:b.delete(w.uuid))}},[g,R]),D.createElement("group",Ze({ref:C},f),Array.from({length:u},(H,w)=>D.createElement("directionalLight",{key:w,castShadow:l,"shadow-bias":e,"shadow-mapSize":[n,n],intensity:d/u},D.createElement("orthographicCamera",{attach:"shadow-camera",args:[-t,t,t,-t,r,s]}))))});class Vi{constructor(e,n,t=1024){this.renderer=e,this.res=t,this.scene=n,this.buffer1Active=!1,this.lights=[],this.meshes=[],this.object=null,this.clearColor=new We,this.clearAlpha=0;const r={type:we,magFilter:Pn,minFilter:Pn};this.progressiveLightMap1=new Ct(this.res,this.res,r),this.progressiveLightMap2=new Ct(this.res,this.res,r),this.discardMat=new Fi,this.targetMat=new ea({fog:!1}),this.previousShadowMap={value:this.progressiveLightMap1.texture},this.averagingWindow={value:100},this.targetMat.onBeforeCompile=s=>{s.vertexShader=`varying vec2 vUv;
`+s.vertexShader.slice(0,-1)+"vUv = uv; gl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }";const a=s.fragmentShader.indexOf("void main() {");s.fragmentShader=`varying vec2 vUv;
`+s.fragmentShader.slice(0,a)+`uniform sampler2D previousShadowMap;
	uniform float averagingWindow;
`+s.fragmentShader.slice(a-1,-1)+`
vec3 texelOld = texture2D(previousShadowMap, vUv).rgb;
        gl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/ averagingWindow);
      }`,s.uniforms.previousShadowMap=this.previousShadowMap,s.uniforms.averagingWindow=this.averagingWindow}}clear(){this.renderer.getClearColor(this.clearColor),this.clearAlpha=this.renderer.getClearAlpha(),this.renderer.setClearColor("black",1),this.renderer.setRenderTarget(this.progressiveLightMap1),this.renderer.clear(),this.renderer.setRenderTarget(this.progressiveLightMap2),this.renderer.clear(),this.renderer.setRenderTarget(null),this.renderer.setClearColor(this.clearColor,this.clearAlpha),this.lights=[],this.meshes=[],this.scene.traverse(e=>{Zi(e)?this.meshes.push({object:e,material:e.material}):Xi(e)&&this.lights.push({object:e,intensity:e.intensity})})}prepare(){this.lights.forEach(e=>e.object.intensity=0),this.meshes.forEach(e=>e.object.material=this.discardMat)}finish(){this.lights.forEach(e=>e.object.intensity=e.intensity),this.meshes.forEach(e=>e.object.material=e.material)}configure(e){this.object=e}update(e,n=100){if(!this.object)return;this.averagingWindow.value=n,this.object.material=this.targetMat;const t=this.buffer1Active?this.progressiveLightMap1:this.progressiveLightMap2,r=this.buffer1Active?this.progressiveLightMap2:this.progressiveLightMap1,s=this.scene.background;this.scene.background=null,this.renderer.setRenderTarget(t),this.previousShadowMap.value=r.texture,this.buffer1Active=!this.buffer1Active,this.renderer.render(this.scene,e),this.renderer.setRenderTarget(null),this.scene.background=s}}const qi={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function $i({radius:l,adjustCamera:e}){const n=bi();return D.useEffect(()=>{e&&n.refresh().clip().fit()},[l,e]),null}function eo({children:l,center:e,adjustCamera:n=!0,intensity:t=.5,shadows:r="contact",environment:s="city",preset:a="rembrandt",...c}){var o,u,d,h,f,B,C,v;const g=typeof a=="string"?qi[a]:a,[{radius:T,height:R},H]=D.useState({radius:0,width:0,height:0,depth:0}),w=(o=r==null?void 0:r.bias)!==null&&o!==void 0?o:-1e-4,b=(u=r==null?void 0:r.normalBias)!==null&&u!==void 0?u:0,M=(d=r==null?void 0:r.size)!==null&&d!==void 0?d:1024,x=(h=r==null?void 0:r.offset)!==null&&h!==void 0?h:0,y=r==="contact"||(r==null?void 0:r.type)==="contact",G=r==="accumulative"||(r==null?void 0:r.type)==="accumulative",U={...typeof r=="object"?r:{}},W=s?typeof s=="string"?{preset:s}:s:null,V=D.useCallback(Y=>{const{width:K,height:ne,depth:z,boundingSphere:Ie}=Y;H({radius:Ie.radius,width:K,height:ne,depth:z}),e!=null&&e.onCentered&&e.onCentered(Y)},[]);return D.createElement(D.Fragment,null,D.createElement("ambientLight",{intensity:t/3}),D.createElement("spotLight",{penumbra:1,position:[g.main[0]*T,g.main[1]*T,g.main[2]*T],intensity:t*2,castShadow:!!r,"shadow-bias":w,"shadow-normalBias":b,"shadow-mapSize":M}),D.createElement("pointLight",{position:[g.fill[0]*T,g.fill[1]*T,g.fill[2]*T],intensity:t}),D.createElement(Di,Ze({fit:!!n,clip:!!n,margin:Number(n),observe:!0},c),D.createElement($i,{radius:T,adjustCamera:n}),D.createElement(Ei,Ze({},e,{position:[0,x/2,0],onCentered:V}),l)),D.createElement("group",{position:[0,-R/2-x/2,0]},y&&D.createElement(ji,Ze({scale:T*4,far:T,blur:2},U)),G&&D.createElement(Wi,Ze({temporal:!0,frames:100,alphaTest:.9,toneMapped:!0,scale:T*4},U),D.createElement(zi,{amount:(f=U.amount)!==null&&f!==void 0?f:8,radius:(B=U.radius)!==null&&B!==void 0?B:T,ambient:(C=U.ambient)!==null&&C!==void 0?C:.5,intensity:(v=U.intensity)!==null&&v!==void 0?v:1,position:[g.main[0]*T,g.main[1]*T,g.main[2]*T],size:T*4,bias:-w,mapSize:M}))),s&&D.createElement(Qi,W))}function to(l){const{nodes:e,materials:n}=qt("/computerModel.glb");return pe.jsxs("group",{...l,dispose:null,children:[pe.jsxs("group",{position:[.121,.007,0],children:[pe.jsx("mesh",{geometry:e.Object_6.geometry,material:n.MacBookPro}),pe.jsx("mesh",{geometry:e.Object_8.geometry,material:n.MacBookPro})]}),pe.jsx("mesh",{geometry:e.Object_4.geometry,material:n.MacBookPro})]})}qt.preload("/computerModel.glb");const no=()=>pe.jsx(ta,{children:pe.jsxs(D.Suspense,{fallback:"loading...",children:[pe.jsx(eo,{environment:"night",intensity:.5,children:pe.jsx(to,{})}),pe.jsx(vi,{enableZoom:!1,autoRotate:!0}),pe.jsx(Ci,{position:[-1,0,1.8],zoom:.8,makeDefault:!0})]})}),Mr={initial:{x:-100,y:-100,opacity:0},animate:{x:0,y:0,opacity:1,transition:{duration:1}}},ro=[{id:1,icon:pe.jsx(na,{className:"text-white text-4xl"}),title:"Software Developer",note:"New Grad, 2025"},{id:2,icon:pe.jsx(ra,{className:"text-white text-4xl"}),title:"Co-op Experience",note:"4 terms, 16 months"},{id:3,icon:pe.jsx(sa,{className:"text-white text-4xl"}),title:"Based in Guelph",note:"Open to remote / hybrid"}],uo=()=>{const l=D.useRef(),e=aa(l,{margin:"-200px"});return pe.jsxs("div",{className:"services",ref:l,children:[pe.jsxs("div",{className:"sSection left",children:[pe.jsx(Gn.h1,{variants:Mr,animate:e?"animate":"initial",className:"sTitle",children:"About Me"}),pe.jsx(Gn.div,{variants:Mr,animate:e?"animate":"initial",className:"serviceList",children:ro.map(n=>pe.jsxs(Gn.div,{whileHover:{scale:1.05,y:-4},transition:{type:"spring",stiffness:300},className:"service p-6",children:[pe.jsx("div",{className:"serviceIcon w-16 h-16 flex items-center justify-center rounded-full bg-[#444]",children:n.icon}),pe.jsxs("div",{className:"serviceInfo text-lg mt-4",children:[pe.jsx("h1",{className:"text-white font-semibold",children:n.title}),pe.jsx("h2",{className:"text-neutral-300",children:n.note})]})]},n.id))})]}),pe.jsx("div",{className:"sSection right",children:pe.jsx(no,{})})]})};export{uo as default};
